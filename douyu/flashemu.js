/*!
 * FlashEmu v2.0.0 (2017-10-26)
 * (c) 2017-2017 spacemeowx2
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.FlashEmu=t()}(this,function(){"use strict";function e(e,t,s,r){var a,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,r);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(i<3?a(n):i>3?a(t,s,n):a(t,s))||n);return i>3&&n&&Object.defineProperty(t,s,n),n}function t(e,t,s,r){return new(s||(s=Promise))(function(a,i){function n(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?a(e.value):new s(function(t){t(e.value)}).then(n,o)}l((r=r.apply(e,t)).next())})}function s(e){Je=e}function r(e,t,s){let r=e;if(t+s<r.length){for(;s--;)if(128!=(192&r[++t]))return!1;return!0}return!1}function a(e){let t=[];for(let s=0;s<e.length;s++)t=t.concat((e=>{let t=[];return e<128?t.push(e):e<2048?(t.push(e>>>6|192),t.push(63&e|128)):e<65536?(t.push(e>>>12|224),t.push(e>>6&63|128),t.push(63&e|128)):e<1<<21&&(t.push(e>>>18|240),t.push(e>>12&63|128),t.push(e>>6&63|128),t.push(63&e|128)),t})(e.charCodeAt(s)));return new Uint8Array(t)}function i(e){let t=[],s=e,a=0,i=e.length;for(;a<i;)if(s[a]<128)t.push(String.fromCharCode(s[a])),++a;else{if(s[a]<192);else if(s[a]<224){if(r(s,a,1)){let e=(31&s[a])<<6|63&s[a+1];if(e>=128){t.push(String.fromCharCode(65535&e)),a+=2;continue}}}else if(s[a]<240){if(r(s,a,2)){let e=(15&s[a])<<12|(63&s[a+1])<<6|63&s[a+2];if(e>=2048&&55296!=(63488&e)){t.push(String.fromCharCode(65535&e)),a+=3;continue}}}else if(s[a]<248&&r(s,a,3)){let e=(7&s[a])<<18|(63&s[a+1])<<12|(63&s[a+2])<<6|63&s[a+3];if(e>65536&&e<1114112){e-=65536,t.push(String.fromCharCode(e>>>10|55296)),t.push(String.fromCharCode(1023&e|56320)),a+=4;continue}}t.push(String.fromCharCode(65533)),++a}return t.join("")}function n(e){return e.map(e=>qe[e>>4]+qe[15&e]).join("")}function o(e,t,s){let r=t;for(;r--;)s[r]=e.pop();s.length=t}function l(e){return e.charCodeAt(0)}function c(){Tt.clear(),vt.clear()}function h(e=20,t="runTime"){let s={},r={};for(let[e,t]of Tt)s[e]=t;return Array.from(Tt.keys()).sort((e,s)=>Tt.get(s)[t]-Tt.get(e)[t]).slice(0,e).forEach(e=>{r[e]=s[e]}),r}function d(e){let t=new Uint8Array(e);return 208===t[0]&&48===t[1]&&71===t[2]}function u(e){return"string"==typeof e?e:void 0===e?null:e+""}function p(e){return"string"==typeof e?e:e+""}function f(e,t){return e==t}function g(e){return typeof e}function m(e){let t=ls.get(e.sec);return t||ls.set(e.sec,t={AXClass:new Map,FunctionClass:new WeakMap}),t}function _(e){return t=>{e||"AX"===(e=t.name).substr(0,2)&&(e=e.substr(2)),os.set(e,t)}}function E(e){return function(t,s,r){const a=t.constructor;if(e=e||s,ns.has(e))throw new Error("duplication of native function name");let i=cs.get(a);i||cs.set(a,i=new Map),i.set(e,s),ns.set(e,a)}}function b(e,t){let s=ns.get(t);if(!s)return null;let r=m(e).FunctionClass,a=r.get(s);return a||r.set(s,a=new s(e)),(...e)=>a[cs.get(s).get(t)].call(a,...e)}function S(e,t){let s;return r=>(!s&&t&&(s=e.getClass(t)),s&&!Lt.isPrimitive(r)&&(Lt.registerObject(r,e),void 0===Lt.getTrait(r)&&(Lt.vPrototype.set(r,s.prototype),Lt.bindTrait(r,s.instTrait),s.accessor&&Lt.vAccesser.set(r,s.accessor))),r)}function w(e,t){return function(){return t(this[e])}}function N(e){return function(t){return this[e]=t}}function y(e,t){const s=t.holder;m(e);let r;if(s instanceof nt)r=s.holderMeta&&s.holderMeta.filter(e=>"native"===e.name);else{if(!(s instanceof pt))throw new Error(`Unsupport trait type`);{const e=s.getClass();r=e.holderMeta&&e.holderMeta.filter(e=>"native"===e.name)}}let a;if(1===r.length){const s=r[0];if(!os.get(s.get("cls")))return null;const i=t.isGetter(),n=t.isSetter(),o=S(e,t.data.method.returnType);let l=t.name.name;return i?w(l,o):n?N(l):a=function(...e){const t=this;t[l]||is.error("propertyKey",l,"not found");let s=t[l].call(this,...e);return o(s)}}throw new Error("No native metadata")}function U(e,t,s){if(!t)return null;const r=os.get(t);let a=m(e).AXClass,i=a.get(t);return i||(r?i=new r(e,t,s):(is.warn("Class",t,"not found"),i=new Mt(e,t)),a.set(t,i),Lt.registerObject(i,e)),i}function T(e){for(var t=e.length;--t>=0;)e[t]=0}function v(e,t,s,r,a){this.static_tree=e,this.extra_bits=t,this.extra_base=s,this.elems=r,this.max_length=a,this.has_stree=e&&e.length}function C(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function I(e){return e<256?wr[e]:wr[256+(e>>>7)]}function P(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function k(e,t,s){e.bi_valid>cr-s?(e.bi_buf|=t<<e.bi_valid&65535,P(e,e.bi_buf),e.bi_buf=t>>cr-e.bi_valid,e.bi_valid+=s-cr):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=s)}function A(e,t,s){k(e,s[2*t],s[2*t+1])}function L(e,t){var s=0;do{s|=1&e,e>>>=1,s<<=1}while(--t>0);return s>>>1}function D(e){16===e.bi_valid?(P(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function O(e,t){var s,r,a,i,n,o,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(i=0;i<=lr;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,s=e.heap_max+1;s<or;s++)(i=l[2*l[2*(r=e.heap[s])+1]+1]+1)>f&&(i=f,g++),l[2*r+1]=i,r>c||(e.bl_count[i]++,n=0,r>=p&&(n=u[r-p]),o=l[2*r],e.opt_len+=o*(i+n),d&&(e.static_len+=o*(h[2*r+1]+n)));if(0!==g){do{for(i=f-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[f]--,g-=2}while(g>0);for(i=f;0!==i;i--)for(r=e.bl_count[i];0!==r;)(a=e.heap[--s])>c||(l[2*a+1]!==i&&(e.opt_len+=(i-l[2*a+1])*l[2*a],l[2*a+1]=i),r--)}}function R(e,t,s){var r,a,i=new Array(lr+1),n=0;for(r=1;r<=lr;r++)i[r]=n=n+s[r-1]<<1;for(a=0;a<=t;a++){var o=e[2*a+1];0!==o&&(e[2*a]=L(i[o]++,o))}}function x(){var e,t,s,r,a,i=new Array(lr+1);for(s=0,r=0;r<sr-1;r++)for(yr[r]=s,e=0;e<1<<gr[r];e++)Nr[s++]=r;for(Nr[s-1]=r,a=0,r=0;r<16;r++)for(Ur[r]=a,e=0;e<1<<mr[r];e++)wr[a++]=r;for(a>>=7;r<ir;r++)for(Ur[r]=a<<7,e=0;e<1<<mr[r]-7;e++)wr[256+a++]=r;for(t=0;t<=lr;t++)i[t]=0;for(e=0;e<=143;)br[2*e+1]=8,e++,i[8]++;for(;e<=255;)br[2*e+1]=9,e++,i[9]++;for(;e<=279;)br[2*e+1]=7,e++,i[7]++;for(;e<=287;)br[2*e+1]=8,e++,i[8]++;for(R(br,ar+1,i),e=0;e<ir;e++)Sr[2*e+1]=5,Sr[2*e]=L(e,5);Tr=new v(br,gr,rr+1,ar,lr),vr=new v(Sr,mr,0,ir,lr),Cr=new v(new Array(0),_r,0,nr,hr)}function M(e){var t;for(t=0;t<ar;t++)e.dyn_ltree[2*t]=0;for(t=0;t<ir;t++)e.dyn_dtree[2*t]=0;for(t=0;t<nr;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*dr]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function B(e){e.bi_valid>8?P(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function F(e,t,s,r){B(e),r&&(P(e,s),P(e,~s)),Zs.arraySet(e.pending_buf,e.window,t,s,e.pending),e.pending+=s}function z(e,t,s,r){var a=2*t,i=2*s;return e[a]<e[i]||e[a]===e[i]&&r[t]<=r[s]}function H(e,t,s){for(var r=e.heap[s],a=s<<1;a<=e.heap_len&&(a<e.heap_len&&z(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!z(t,r,e.heap[a],e.depth));)e.heap[s]=e.heap[a],s=a,a<<=1;e.heap[s]=r}function G(e,t,s){var r,a,i,n,o=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],a=e.pending_buf[e.l_buf+o],o++,0===r?A(e,a,t):(A(e,(i=Nr[a])+rr+1,t),0!==(n=gr[i])&&k(e,a-=yr[i],n),A(e,i=I(--r),s),0!==(n=mr[i])&&k(e,r-=Ur[i],n))}while(o<e.last_lit);A(e,dr,t)}function W(e,t){var s,r,a,i=t.dyn_tree,n=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=or,s=0;s<l;s++)0!==i[2*s]?(e.heap[++e.heap_len]=c=s,e.depth[s]=0):i[2*s+1]=0;for(;e.heap_len<2;)i[2*(a=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[a]=0,e.opt_len--,o&&(e.static_len-=n[2*a+1]);for(t.max_code=c,s=e.heap_len>>1;s>=1;s--)H(e,i,s);a=l;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],H(e,i,1),r=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=r,i[2*a]=i[2*s]+i[2*r],e.depth[a]=(e.depth[s]>=e.depth[r]?e.depth[s]:e.depth[r])+1,i[2*s+1]=i[2*r+1]=a,e.heap[1]=a++,H(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],O(e,t),R(i,c,e.bl_count)}function V(e,t,s){var r,a,i=-1,n=t[1],o=0,l=7,c=4;for(0===n&&(l=138,c=3),t[2*(s+1)+1]=65535,r=0;r<=s;r++)a=n,n=t[2*(r+1)+1],++o<l&&a===n||(o<c?e.bl_tree[2*a]+=o:0!==a?(a!==i&&e.bl_tree[2*a]++,e.bl_tree[2*ur]++):o<=10?e.bl_tree[2*pr]++:e.bl_tree[2*fr]++,o=0,i=a,0===n?(l=138,c=3):a===n?(l=6,c=3):(l=7,c=4))}function X(e,t,s){var r,a,i=-1,n=t[1],o=0,l=7,c=4;for(0===n&&(l=138,c=3),r=0;r<=s;r++)if(a=n,n=t[2*(r+1)+1],!(++o<l&&a===n)){if(o<c)do{A(e,a,e.bl_tree)}while(0!=--o);else 0!==a?(a!==i&&(A(e,a,e.bl_tree),o--),A(e,ur,e.bl_tree),k(e,o-3,2)):o<=10?(A(e,pr,e.bl_tree),k(e,o-3,3)):(A(e,fr,e.bl_tree),k(e,o-11,7));o=0,i=a,0===n?(l=138,c=3):a===n?(l=6,c=3):(l=7,c=4)}}function j(e){var t;for(V(e,e.dyn_ltree,e.l_desc.max_code),V(e,e.dyn_dtree,e.d_desc.max_code),W(e,e.bl_desc),t=nr-1;t>=3&&0===e.bl_tree[2*Er[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function Y(e,t,s,r){var a;for(k(e,t-257,5),k(e,s-1,5),k(e,r-4,4),a=0;a<r;a++)k(e,e.bl_tree[2*Er[a]+1],3);X(e,e.dyn_ltree,t-1),X(e,e.dyn_dtree,s-1)}function Z(e){var t,s=4093624447;for(t=0;t<=31;t++,s>>>=1)if(1&s&&0!==e.dyn_ltree[2*t])return Js;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Qs;for(t=32;t<rr;t++)if(0!==e.dyn_ltree[2*t])return Qs;return Js}function K(e,t,s,r){k(e,($s<<1)+(r?1:0),3),F(e,t,s,!0)}function J(e,t){return e.msg=Or[t],t}function Q(e){return(e<<1)-(e>4?9:0)}function q(e){for(var t=e.length;--t>=0;)e[t]=0}function $(e){var t=e.state,s=t.pending;s>e.avail_out&&(s=e.avail_out),0!==s&&(Zs.arraySet(e.output,t.pending_buf,t.pending_out,s,e.next_out),e.next_out+=s,t.pending_out+=s,e.total_out+=s,e.avail_out-=s,t.pending-=s,0===t.pending&&(t.pending_out=0))}function ee(e,t){kr._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,$(e.strm)}function te(e,t){e.pending_buf[e.pending++]=t}function se(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function re(e,t,s,r){var a=e.avail_in;return a>r&&(a=r),0===a?0:(e.avail_in-=a,Zs.arraySet(t,e.input,e.next_in,a,s),1===e.state.wrap?e.adler=Ar(e.adler,t,a,s):2===e.state.wrap&&(e.adler=Dr(e.adler,t,a,s)),e.next_in+=a,e.total_in+=a,a)}function ae(e,t){var s,r,a=e.max_chain_length,i=e.strstart,n=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-ca?e.strstart-(e.w_size-ca):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+la,p=c[i+n-1],f=c[i+n];e.prev_length>=e.good_match&&(a>>=2),o>e.lookahead&&(o=e.lookahead);do{if(s=t,c[s+n]===f&&c[s+n-1]===p&&c[s]===c[i]&&c[++s]===c[i+1]){i+=2,s++;do{}while(c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&i<u);if(r=la-(u-i),i=u-la,r>n){if(e.match_start=t,n=r,r>=o)break;p=c[i+n-1],f=c[i+n]}}}while((t=d[t&h])>l&&0!=--a);return n<=e.lookahead?n:e.lookahead}function ie(e){var t,s,r,a,i,n=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-ca)){Zs.arraySet(e.window,e.window,n,n,0),e.match_start-=n,e.strstart-=n,e.block_start-=n,t=s=e.hash_size;do{r=e.head[--t],e.head[t]=r>=n?r-n:0}while(--s);t=s=n;do{r=e.prev[--t],e.prev[t]=r>=n?r-n:0}while(--s);a+=n}if(0===e.strm.avail_in)break;if(s=re(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=s,e.lookahead+e.insert>=oa)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+oa-1])&e.hash_mask,e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<oa)););}while(e.lookahead<ca&&0!==e.strm.avail_in)}function ne(e,t){for(var s,r;;){if(e.lookahead<ca){if(ie(e),e.lookahead<ca&&t===Rr)return Ea;if(0===e.lookahead)break}if(s=0,e.lookahead>=oa&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+oa-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==s&&e.strstart-s<=e.w_size-ca&&(e.match_length=ae(e,s)),e.match_length>=oa)if(r=kr._tr_tally(e,e.strstart-e.match_start,e.match_length-oa),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=oa){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+oa-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=kr._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(ee(e,!1),0===e.strm.avail_out))return Ea}return e.insert=e.strstart<oa-1?e.strstart:oa-1,t===Br?(ee(e,!0),0===e.strm.avail_out?Sa:wa):e.last_lit&&(ee(e,!1),0===e.strm.avail_out)?Ea:ba}function oe(e,t){for(var s,r,a;;){if(e.lookahead<ca){if(ie(e),e.lookahead<ca&&t===Rr)return Ea;if(0===e.lookahead)break}if(s=0,e.lookahead>=oa&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+oa-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=oa-1,0!==s&&e.prev_length<e.max_lazy_match&&e.strstart-s<=e.w_size-ca&&(e.match_length=ae(e,s),e.match_length<=5&&(e.strategy===jr||e.match_length===oa&&e.strstart-e.match_start>4096)&&(e.match_length=oa-1)),e.prev_length>=oa&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-oa,r=kr._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-oa),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+oa-1])&e.hash_mask,s=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=oa-1,e.strstart++,r&&(ee(e,!1),0===e.strm.avail_out))return Ea}else if(e.match_available){if((r=kr._tr_tally(e,0,e.window[e.strstart-1]))&&ee(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return Ea}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=kr._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<oa-1?e.strstart:oa-1,t===Br?(ee(e,!0),0===e.strm.avail_out?Sa:wa):e.last_lit&&(ee(e,!1),0===e.strm.avail_out)?Ea:ba}function le(e,t){for(var s,r,a,i,n=e.window;;){if(e.lookahead<=la){if(ie(e),e.lookahead<=la&&t===Rr)return Ea;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=oa&&e.strstart>0&&(a=e.strstart-1,(r=n[a])===n[++a]&&r===n[++a]&&r===n[++a])){i=e.strstart+la;do{}while(r===n[++a]&&r===n[++a]&&r===n[++a]&&r===n[++a]&&r===n[++a]&&r===n[++a]&&r===n[++a]&&r===n[++a]&&a<i);e.match_length=la-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=oa?(s=kr._tr_tally(e,1,e.match_length-oa),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(s=kr._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),s&&(ee(e,!1),0===e.strm.avail_out))return Ea}return e.insert=0,t===Br?(ee(e,!0),0===e.strm.avail_out?Sa:wa):e.last_lit&&(ee(e,!1),0===e.strm.avail_out)?Ea:ba}function ce(e,t){for(var s;;){if(0===e.lookahead&&(ie(e),0===e.lookahead)){if(t===Rr)return Ea;break}if(e.match_length=0,s=kr._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,s&&(ee(e,!1),0===e.strm.avail_out))return Ea}return e.insert=0,t===Br?(ee(e,!0),0===e.strm.avail_out?Sa:wa):e.last_lit&&(ee(e,!1),0===e.strm.avail_out)?Ea:ba}function he(e,t,s,r,a){this.good_length=e,this.max_lazy=t,this.nice_length=s,this.max_chain=r,this.func=a}function de(e){e.window_size=2*e.w_size,q(e.head),e.max_lazy_match=Ir[e.level].max_lazy,e.good_match=Ir[e.level].good_length,e.nice_match=Ir[e.level].nice_length,e.max_chain_length=Ir[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=oa-1,e.match_available=0,e.ins_h=0}function ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=qr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Zs.Buf16(2*ia),this.dyn_dtree=new Zs.Buf16(2*(2*ra+1)),this.bl_tree=new Zs.Buf16(2*(2*aa+1)),q(this.dyn_ltree),q(this.dyn_dtree),q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Zs.Buf16(na+1),this.heap=new Zs.Buf16(2*sa+1),q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Zs.Buf16(2*sa+1),q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pe(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Qr,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?da:ma,e.adler=2===t.wrap?0:1,t.last_flush=Rr,kr._tr_init(t),zr):J(e,Gr)}function fe(e){var t=pe(e);return t===zr&&de(e.state),t}function ge(e,t,s,r,a,i){if(!e)return Gr;var n=1;if(t===Xr&&(t=6),r<0?(n=0,r=-r):r>15&&(n=2,r-=16),a<1||a>$r||s!==qr||r<8||r>15||t<0||t>9||i<0||i>Kr)return J(e,Gr);8===r&&(r=9);var o=new ue;return e.state=o,o.strm=e,o.wrap=n,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+oa-1)/oa),o.window=new Zs.Buf8(2*o.w_size),o.head=new Zs.Buf16(o.hash_size),o.prev=new Zs.Buf16(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Zs.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=i,o.method=s,fe(e)}function me(e,t){if(t<65537&&(e.subarray&&Ta||!e.subarray&&Ua))return String.fromCharCode.apply(null,Zs.shrinkBuf(e,t));for(var s="",r=0;r<t;r++)s+=String.fromCharCode(e[r]);return s}function _e(e){if(!(this instanceof _e))return new _e(e);this.options=Zs.assign({level:La,method:Oa,chunkSize:16384,windowBits:15,memLevel:8,strategy:Da,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Pa,this.strm.avail_out=0;var s=ya.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(s!==Aa)throw new Error(Or[s]);if(t.header&&ya.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(r="string"==typeof t.dictionary?Ia.string2buf(t.dictionary):"[object ArrayBuffer]"===ka.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(s=ya.deflateSetDictionary(this.strm,r))!==Aa)throw new Error(Or[s]);this._dict_set=!0}}function Ee(e,t){var s=new _e(t);if(s.push(e,!0),s.err)throw s.msg||Or[s.err];return s.result}function be(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function Se(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Zs.Buf16(320),this.work=new Zs.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function we(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=ai,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Zs.Buf32(xi),t.distcode=t.distdyn=new Zs.Buf32(Mi),t.sane=1,t.back=-1,Ja):$a}function Ne(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,we(e)):$a}function ye(e,t){var s,r;return e&&e.state?(r=e.state,t<0?(s=0,t=-t):(s=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?$a:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=s,r.wbits=t,Ne(e))):$a}function Ue(e,t){var s,r;return e?(r=new Se,e.state=r,r.window=null,(s=ye(e,t))!==Ja&&(e.state=null),s):$a}function Te(e){if(Fi){var t;for(Ra=new Zs.Buf32(512),xa=new Zs.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Wa(Xa,e.lens,0,288,Ra,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Wa(ja,e.lens,0,32,xa,0,e.work,{bits:5}),Fi=!1}e.lencode=Ra,e.lenbits=9,e.distcode=xa,e.distbits=5}function ve(e,t,s,r){var a,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Zs.Buf8(i.wsize)),r>=i.wsize?(Zs.arraySet(i.window,t,s-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):((a=i.wsize-i.wnext)>r&&(a=r),Zs.arraySet(i.window,t,s-r,a,i.wnext),(r-=a)?(Zs.arraySet(i.window,t,s-r,r,0),i.wnext=r,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0}function Ce(e){if(!(this instanceof Ce))return new Ce(e);this.options=Zs.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Pa,this.strm.avail_out=0;var s=zi.inflateInit2(this.strm,t.windowBits);if(s!==Hi.Z_OK)throw new Error(Or[s]);this.header=new Gi,zi.inflateGetHeader(this.strm,this.header)}function Ie(e,t){var s=new Ce(t);if(s.push(e,!0),s.err)throw s.msg||Or[s.err];return s.result}function Pe(e){return t(this,void 0,void 0,function*(){return ji(new Uint8Array(e)).buffer})}function ke(e,s){return t(this,void 0,void 0,function*(){return en.decodeSWF(new Uint8Array(e),s).buffer})}function Ae(e){return function(t){t.type=e,tn.set(e,t)}}const Le=7,De=13,Oe=15,Re=16,xe=17,Me=18,Be=9,Fe=14,ze=27,He=28,Ge=29;var We;!function(e){e[e.NEED_ARGUMENTS=1]="NEED_ARGUMENTS",e[e.NEED_ACTIVATION=2]="NEED_ACTIVATION",e[e.NEED_REST=4]="NEED_REST",e[e.HAS_OPTIONAL=8]="HAS_OPTIONAL",e[e.Native=32]="Native",e[e.SET_DXNS=64]="SET_DXNS",e[e.HAS_PARAM_NAMES=128]="HAS_PARAM_NAMES"}(We||(We={}));var Ve;!function(e){e[e.Int=3]="Int",e[e.UInt=4]="UInt",e[e.Double=6]="Double",e[e.Utf8=1]="Utf8",e[e.True=11]="True",e[e.False=10]="False",e[e.Null=12]="Null",e[e.Undefined=0]="Undefined",e[e.Namespace=8]="Namespace",e[e.PackageNamespace=22]="PackageNamespace",e[e.PackageInternalNs=23]="PackageInternalNs",e[e.ProtectedNamespace=24]="ProtectedNamespace",e[e.ExplicitNamespace=25]="ExplicitNamespace",e[e.StaticProtectedNs=26]="StaticProtectedNs",e[e.PrivateNs=5]="PrivateNs"}(Ve||(Ve={}));const Xe=[8,22,23,24,25,26,5];var je;!function(e){e[e.Public=0]="Public",e[e.Protected=1]="Protected",e[e.PackageInternal=2]="PackageInternal",e[e.Private=3]="Private",e[e.Explicit=4]="Explicit",e[e.StaticProtected=5]="StaticProtected"}(je||(je={}));var Ye;!function(e){e[e.Slot=0]="Slot",e[e.Method=1]="Method",e[e.Getter=2]="Getter",e[e.Setter=3]="Setter",e[e.Class=4]="Class",e[e.Function=5]="Function",e[e.Const=6]="Const",e[e.GetterSetter=7]="GetterSetter"}(Ye||(Ye={}));var Ze;!function(e){e[e.Final=1]="Final",e[e.Override=2]="Override",e[e.Metadata=4]="Metadata"}(Ze||(Ze={}));var Ke;!function(e){e[e.ClassSealed=1]="ClassSealed",e[e.ClassFinal=2]="ClassFinal",e[e.ClassInterface=4]="ClassInterface",e[e.ClassProtectedNs=8]="ClassProtectedNs"}(Ke||(Ke={}));let Je={enableDebug:!1,enableLog:!1,enableWarn:!0,enableError:!0};class Qe{constructor(e){this._tag=e,this.enableDebug=null,this.enableLog=null,this.enableWarn=null,this.enableError=null,this._tag=`[${e}]`}get tag(){return this._tag}get _enableDebug(){return Qe.logFilter(this._tag)&&null===this.enableDebug?Je.enableDebug:this.enableDebug}get _enableLog(){return Qe.logFilter(this._tag)&&null===this.enableLog?Je.enableLog:this.enableLog}get _enableWarn(){return Qe.logFilter(this._tag)&&null===this.enableWarn?Je.enableWarn:this.enableWarn}get _enableError(){return Qe.logFilter(this._tag)&&null===this.enableError?Je.enableError:this.enableError}debug(...e){this._enableDebug&&console.log(this.tag,...e)}log(...e){this._enableLog&&console.log(this.tag,...e)}warn(...e){this._enableWarn&&console.log(this.tag,...e)}error(...e){this._enableError&&console.error(this.tag,...e)}}Qe.logFilter=(e=>!0);new Qe("Utils");const qe="0123456789abcdef";class $e extends Error{}class et{constructor(e){this.buffer=e,this.dataView=new DataView(e,0),this.ptr=0}isEOF(){return this.ptr>=this.buffer.byteLength}throwEOF(){throw new $e("Read EOF")}movePtr(e){const t=this.ptr;return this.ptr+=e,this.ptr>this.buffer.byteLength&&this.throwEOF(),t}readU8(){const e=this.ptr;return this.ptr=e+1,this.dataView.getUint8(e)}readU16(){return this.dataView.getUint16(this.movePtr(2),!0)}readUI16(){return this.dataView.getUint16(this.movePtr(2),!0)}readUI32(){return this.dataView.getUint32(this.movePtr(4),!0)}readS8(){return this.dataView.getInt8(this.movePtr(1))}readS24(){let e=this.readU8(),t=this.readU16()<<8|e;return t=t<<8>>8}readU30(){const e=this.dataView;let t,s=this.ptr,r=e.getUint8(s),a=127&r;for(t=1;128&r&&t<5;t++)a|=(127&(r=e.getUint8(s+t)))<<7*t;return this.ptr+=t,a>>>0}readU32(){return this.readU30()}readS32(){return 0|this.readU32()}readD64(){return this.dataView.getFloat64(this.movePtr(8),!0)}readString(e){return i(new Uint8Array(this.readArray(e)))}readCStyleString(){let e,t;for(t=this.ptr;0!==e;t++)e=this.dataView.getUint8(t);let s=new Uint8Array(this.readArray(t-this.ptr-1));return this.readU8(),i(s)}readArray(e){e<0&&(e+=this.buffer.byteLength-this.ptr+1),this.ptr+e>this.buffer.byteLength&&(console.error("EOF",this.ptr,e,this.buffer.byteLength),this.throwEOF());let t=this.buffer.slice(this.ptr,this.ptr+e);return this.ptr+=e,t}getPosition(){return this.ptr}}class tt extends WeakMap{constructor(e){super(),this.def=e}get(e){let t=super.get(e);return void 0===t&&(t=this.def),t}}new Qe("Abc");class st{constructor(e,t,s=""){this._type=e,this._uri=t,this._prefix=s,this._mangledName=null,null===this._uri&&(this._uri=""),null===this._prefix&&(this._prefix="")}static Package(e){return new st(je.Public,e)}static PackageInternal(e){return new st(je.PackageInternal,e)}static get Public(){return st._public||(st._public=new st(je.Public,"")),st._public}static Private(e=""){return new st(je.Private,e)}static MangledName(e,t,s){return e===je.Public&&""===t?st.PublicMangledName:"_"+e.toString(16)+"_"+s+"_"+t}static read(e,t){let s,r=e.readU8();switch(r){case Ve.Namespace:case Ve.PackageNamespace:s=je.Public;break;case Ve.PackageInternalNs:s=je.PackageInternal;break;case Ve.ProtectedNamespace:s=je.Protected;break;case Ve.ExplicitNamespace:s=je.Explicit;break;case Ve.StaticProtectedNs:s=je.StaticProtected;break;case Ve.PrivateNs:s=je.Private;break;default:throw new Error("Namespace type error.")}let a=null;return Xe.includes(r)?a=t.getString(e.readU30()):console.error("kind not includes",r),new st(s,a)}get type(){return this._type}get uri(){return this._uri}get prefix(){return this._prefix}get mangledName(){return this._mangledName||(this._mangledName=st.MangledName(this._type,this._uri,this._prefix)),this._mangledName}isPublic(){return this._type===je.Public}Multiname(e){return _t.QName(this,e)}toString(){return this._uri}}st.PublicMangledName="_public";class rt{static read(e,t){let s=new rt;if(s.start=e.readU30(),s.end=e.readU30(),s.target=e.readU30(),s.excType=t.getMultiname(e.readU30()),s.varName=t.getMultiname(e.readU30()),s.varName){let e=new dt(t);e.holder=s,e.name=s.varName,e.kindType=Ye.Slot,e.data=new ot(t),e.data.typeName=s.excType,s.traits=new ut(e)}return s}getTrait(){return this.traits}}class at{static read(e,t){let s=new at;s.method=t.getMethod(e.readU30()),s.maxStack=e.readU30(),s.localCount=e.readU30(),s.initScopeDepth=e.readU30(),s.maxScopeDepth=e.readU30();const r=e.readU30();s.code=e.readArray(r);const a=e.readU30();s.exception=[];for(let r=0;r<a;r++)s.exception.push(rt.read(e,t));const i=e.readU30();s.trait=new ut;for(let r=0;r<i;r++)s.trait.push(dt.read(e,t,s));return s}}class it{constructor(e){this.abc=e}static read(e,t){let s=new it(t);s.init=t.getMethod(e.readU30());const r=e.readU30();s.trait=new ut;for(let a=0;a<r;a++)s.trait.push(dt.read(e,t,s));return s}getID(){return this.abc.script.indexOf(this)}}class nt{constructor(e){this.abc=e,this.trait=new ut,this.holderMeta=[]}static read(e,t){let s=new nt(t);s.cinit=t.getMethod(e.readU30());const r=e.readU30();for(let a=0;a<r;a++)s.trait.push(dt.read(e,t,s));return s}getInstance(){return this.abc?this.abc.getInstanceByClass(this):null}}class ot{constructor(e){this.abc=e,this.vkind=-1}static read(e,t){let s=new ot(t);return s.slotId=e.readU30(),s.typeName=t.getMultiname(e.readU30()),s.vindex=e.readU30(),0!==s.vindex&&(s.vkind=e.readU8()),s}getDefaultValue(){if(-1===this.vkind){if(null===this.typeName)return;let e=Et[this.typeName.mangledName];return void 0===e?null:e}return this.abc.getConstant(this.vkind,this.vindex)}}class lt extends ot{constructor(e){super(e),this.vkind=0,this.vindex=-1,this.typeName=null}static read(e,t){let s=new lt(t);return s.slotId=e.readU30(),s.classi=t.getClass(e.readU30()),s}}class ct{static read(e,t){let s=new ct;return s.dispId=e.readU30(),s.method=t.getMethod(e.readU30()),s}}class ht{static read(e,t){let s=new ht;return s.slotId=e.readU30(),s.function=t.getMethod(e.readU30()),s}}class dt{constructor(e){this.abc=e}static read(e,t,s){let r=new dt(t);r.holder=s,r.name=t.getMultiname(e.readU30());const a=e.readU8();switch(r.kindType=15&a,r.kindFlags=a>>4,r.data=null,r.kindType){case Ye.Slot:case Ye.Const:r.data=ot.read(e,t);break;case Ye.Method:case Ye.Getter:case Ye.Setter:r.data=ct.read(e,t);break;case Ye.Class:r.data=lt.read(e,t);break;case Ye.Function:r.data=ht.read(e,t)}if(0!=(r.kindFlags&Ze.Metadata)){const s=e.readU30();r.metadata=[];for(let a=0;a<s;a++)r.metadata.push(t.getMetadata(e.readU30()))}if(r.data instanceof lt){const e=r.data.classi;r.metadata&&(e.holderMeta=e.holderMeta.concat(r.metadata)),e.holderTraitName=r.name}return r}isSetter(){return this.kindType===Ye.Setter}isGetter(){return this.kindType===Ye.Getter}isMethod(){return this.kindType===Ye.Method}}class ut extends Array{getTrait(e){let t=e.name,s=e.nsSet,r=this;for(let e of r){let r=e.name;if(r.name===t){let t=r.nsSet[0];for(let r=0;r<s.length;r++)if(t.mangledName===s[r].mangledName)return e}}return null}}class pt{constructor(e){this.abc=e}static read(e,t){let s=new pt(t);s.name=t.getMultiname(e.readU30()),s.superName=t.getMultiname(e.readU30()),s.flags=e.readU8(),0!=(s.flags&Ke.ClassProtectedNs)&&(s.protectedNs=t.getNamespace(e.readU30()));const r=e.readU30();s.interface=[];for(let a=0;a<r;a++)s.interface.push(t.getMultiname(e.readU30()));s.iinit=t.getMethod(e.readU30());const a=e.readU30();s.trait=new ut;for(let r=0;r<a;r++)s.trait.push(dt.read(e,t,s));return s}getClass(){return this.abc.getClassByInstance(this)}}class ft extends Map{static read(e,t){let s=new ft;s.name=t.getString(e.readU30());const r=e.readU30();let a=[];for(let s=0;s<r;s++)a.push(t.getString(e.readU30()));for(let i=0;i<r;i++){const r=t.getString(e.readU30());null===a[i]?s.value=r:s.set(a[i],r)}return s}toJSON(){let e={};for(let t of this.entries())e[t[0]]=t[1];return e.__name__=this.name,e}}class gt{static read(e,t){let s=new gt,r=e.readU30();return s.kind=e.readU8(),s.val=t.getConstant(s.kind,r),s}}class mt{constructor(e){this.abc=e}static read(e,t){let s=new mt(t);const r=e.readU30();s.returnType=t.getMultiname(e.readU30()),s.paramType=[];for(let a=0;a<r;a++)s.paramType.push(t.getMultiname(e.readU30()));if(s.name=t.getString(e.readU30()),s.flags=e.readU8(),s.options=[],0!=(s.flags&We.HAS_OPTIONAL)){const r=e.readU30();for(let a=0;a<r;a++)s.options.push(gt.read(e,t))}if(s.paramNames=[],0!=(s.flags&We.HAS_PARAM_NAMES))for(let a=0;a<r;a++)s.paramNames.push(t.getString(e.readU30()));return s.flags,We.Native,s}getBody(){return this.abc.getMethodBodyByMethod(this)}needsRest(){return 0!=(this.flags&We.NEED_REST)}isNative(){return 0!=(this.flags&We.Native)}}class _t{constructor(){this._mangledName=null}static Public(e){let t=new _t;return t.kind=Le,t.nsSet=[new st(je.Public,"")],t.name=e,t}static Package(e,t){let s=new _t;return s.kind=Le,s.nsSet=[st.Package(e)],s.name=t,s}static PackageInternal(e,t){let s=new _t;return s.kind=Le,s.nsSet=[st.PackageInternal(e)],s.name=t,s}static QName(e,t){let s=new _t;return s.kind=Le,s.nsSet=[e],s.name=t,s}static PublicMangledName(e){return _t.MangledName(st.Public,e)}static MangledName(e,t){return"$"+e.mangledName+"-"+t}static stripPublicMangledName(e){const t=_t.PublicMangledName("");return e.startsWith(t)?e.substr(t.length):null}static read(e,t){let s,r,a,i=e.readU8(),n=[],o=!1;switch(i){case Le:case De:n=[t.getNamespace(e.readU30())],s=t.getString(e.readU30());break;case Oe:case Re:s=t.getString(e.readU30());break;case xe:case Me:break;case Be:case Fe:s=t.getString(e.readU30()),n=t.getNsSet(e.readU30());break;case ze:case He:n=t.getNsSet(e.readU30());break;case Ge:o=!0,r=e.readU30();const l=e.readU30();a=[];for(let t=0;t<l;t++)a.push(e.readU30());break;default:console.error("Unknown kind of Multiname:"+i)}return e=>{let t=new _t;return t.kind=i,t.name=s,t.nsSet=n,t.kind===Ge&&(t.factory=e(r),t.params=a.map(t=>e(t)),t.nsSet=t.factory.nsSet,t.name=t.factory.name),t}}get mangledName(){let e=this._mangledName;return e||(e=this._mangledName=_t.MangledName(this.nsSet[0],this.name)),e}toString(){let e=this.nsSet[0];return e?e.toString()+":"+this.name:this.name}toJSON(){return this.kind===Le&&1===this.nsSet.length?this.nsSet[0].isPublic()?this.name:`${this.nsSet[0].uri}::${this.name}`:this}isRuntimeName(){switch(this.kind){case xe:case Me:case ze:case He:return!0}return!1}isRuntime(){switch(this.kind){case Le:case De:case Be:case Fe:return!1}return!0}isRuntimeNamespace(){switch(this.kind){case Oe:case Re:case xe:case Me:return!0}return!1}isAttribute(){switch(this.kind){case De:case Re:case Me:case Fe:case He:return!0}return!1}isAnyName(){return null===this.name}}let Et={[_t.PublicMangledName("Number")]:NaN,[_t.PublicMangledName("int")]:0,[_t.PublicMangledName("uint")]:0,[_t.PublicMangledName("Boolean")]:!1};class bt{static read(e,t,s){const r=t.readU30()-1;e.integer=[null];for(let s=0;s<r;s++)e.integer.push(t.readS32());const a=t.readU30()-1;e.uinteger=[null];for(let s=0;s<a;s++)e.uinteger.push(t.readU32());const i=t.readU30()-1;e.double=[null];for(let s=0;s<i;s++)e.double.push(t.readD64());const n=t.readU30()-1;e.string=[null];for(let s=0;s<n;s++){const s=t.readU30();e.string.push(t.readString(s))}const o=t.readU30()-1;e.namespace=[null];for(let r=0;r<o;r++)e.namespace.push(st.read(t,s));const l=t.readU30()-1;e.nsSet=[null];for(let r=0;r<l;r++){let r=[];const a=t.readU30();for(let e=0;e<a;e++)r.push(s.getNamespace(t.readU30()));e.nsSet.push(r)}const c=t.readU30()-1;let h=[null];for(let e=0;e<c;e++)h.push(_t.read(t,s));const d=e=>{let t=h[e];return t instanceof _t?t:t(d)};for(let e=1;e<=c;e++)h[e]=d(e);return e.multiname=h,e}}class St{constructor(){this.methodBody=this.instance=this.cls=new WeakMap}}class wt{constructor(e,t){this.app=t,this.minorVersion=e.readU16(),this.majorVersion=e.readU16(),this.constantPool=new bt,bt.read(this.constantPool,e,this);const s=e.readU30();this.method=[];for(let t=0;t<s;t++)this.method.push(mt.read(e,this));for(let e=0;e<s;e++)this.method[e].id=e;const r=e.readU30();this.metadata=[];for(let t=0;t<r;t++)this.metadata.push(ft.read(e,this));const a=e.readU30();this.instance=[];for(let t=0;t<a;t++)this.instance.push(pt.read(e,this));this.classes=[];for(let t=0;t<a;t++)this.classes.push(nt.read(e,this));const i=e.readU30();this.script=[];for(let t=0;t<i;t++)this.script.push(it.read(e,this));const n=e.readU30();this.methodBody=[];for(let t=0;t<n;t++)this.methodBody.push(at.read(e,this));this.map=new St;for(let e of this.methodBody)this.map.methodBody.set(e.method,e);for(let e=0;e<a;e++)this.map.instance.set(this.classes[e],this.instance[e]),this.map.cls.set(this.instance[e],this.classes[e])}getMetadata(e){return this.metadata[e]}getMethodBodyByMethod(e){return this.map.methodBody.get(e)}getInstanceByClass(e){return this.map.instance.get(e)}getClassByInstance(e){return this.map.cls.get(e)}getMethod(e){return this.method[e]}getString(e){return this.constantPool.string[e]}getMultiname(e){return this.constantPool.multiname[e]}getNamespace(e){return this.constantPool.namespace[e]}getClass(e){return this.classes[e]}getNsSet(e){return this.constantPool.nsSet[e]}getScript(e){return this.script[e]}getUInt(e){return this.constantPool.uinteger[e]}getInt(e){return this.constantPool.integer[e]}getDouble(e){return this.constantPool.double[e]}getConstant(e,t){switch(e){case Ve.Int:return this.getInt(t);case Ve.UInt:return this.getUInt(t);case Ve.Double:return this.getDouble(t);case Ve.Utf8:return this.getString(t);case Ve.True:case Ve.False:return Ve.True===e;case Ve.Null:return null;case Ve.Undefined:return;default:if(Xe.includes(e))return this.getNamespace(t);throw new Error("Unknown constant kind"+e)}}toJSON(){let e=(new Error).stack;return e.length-e.replace(/AbcFile\.toJSON/g,"AbcFiletoJSON").length>1?null:JSON.parse(JSON.stringify({minorVersion:this.minorVersion,majorVersion:this.majorVersion,script:this.script,classes:this.classes,instance:this.instance,method:this.method,methodBody:this.methodBody},(e,t)=>{if("abc"!==e&&"app"!==e&&"holder"!==e)return"kind"===e||"_kind"===e?`0x${t.toString(16)}`:t instanceof ArrayBuffer?n(Array.from(new Uint8Array(t))):(t instanceof Object&&t.constructor&&t.constructor.name&&(t.cType=t.constructor.name),t)}))}}var Nt;!function(e){e[e.BKPT=1]="BKPT",e[e.NOP=2]="NOP",e[e.THROW=3]="THROW",e[e.GETSUPER=4]="GETSUPER",e[e.SETSUPER=5]="SETSUPER",e[e.DXNS=6]="DXNS",e[e.DXNSLATE=7]="DXNSLATE",e[e.KILL=8]="KILL",e[e.LABEL=9]="LABEL",e[e.LF32X4=10]="LF32X4",e[e.SF32X4=11]="SF32X4",e[e.IFNLT=12]="IFNLT",e[e.IFNLE=13]="IFNLE",e[e.IFNGT=14]="IFNGT",e[e.IFNGE=15]="IFNGE",e[e.JUMP=16]="JUMP",e[e.IFTRUE=17]="IFTRUE",e[e.IFFALSE=18]="IFFALSE",e[e.IFEQ=19]="IFEQ",e[e.IFNE=20]="IFNE",e[e.IFLT=21]="IFLT",e[e.IFLE=22]="IFLE",e[e.IFGT=23]="IFGT",e[e.IFGE=24]="IFGE",e[e.IFSTRICTEQ=25]="IFSTRICTEQ",e[e.IFSTRICTNE=26]="IFSTRICTNE",e[e.LOOKUPSWITCH=27]="LOOKUPSWITCH",e[e.PUSHWITH=28]="PUSHWITH",e[e.POPSCOPE=29]="POPSCOPE",e[e.NEXTNAME=30]="NEXTNAME",e[e.HASNEXT=31]="HASNEXT",e[e.PUSHNULL=32]="PUSHNULL",e[e.PUSHUNDEFINED=33]="PUSHUNDEFINED",e[e.PUSHFLOAT=34]="PUSHFLOAT",e[e.NEXTVALUE=35]="NEXTVALUE",e[e.PUSHBYTE=36]="PUSHBYTE",e[e.PUSHSHORT=37]="PUSHSHORT",e[e.PUSHTRUE=38]="PUSHTRUE",e[e.PUSHFALSE=39]="PUSHFALSE",e[e.PUSHNAN=40]="PUSHNAN",e[e.POP=41]="POP",e[e.DUP=42]="DUP",e[e.SWAP=43]="SWAP",e[e.PUSHSTRING=44]="PUSHSTRING",e[e.PUSHINT=45]="PUSHINT",e[e.PUSHUINT=46]="PUSHUINT",e[e.PUSHDOUBLE=47]="PUSHDOUBLE",e[e.PUSHSCOPE=48]="PUSHSCOPE",e[e.PUSHNAMESPACE=49]="PUSHNAMESPACE",e[e.HASNEXT2=50]="HASNEXT2",e[e.LI8=53]="LI8",e[e.LI16=54]="LI16",e[e.LI32=55]="LI32",e[e.LF32=56]="LF32",e[e.LF64=57]="LF64",e[e.SI8=58]="SI8",e[e.SI16=59]="SI16",e[e.SI32=60]="SI32",e[e.SF32=61]="SF32",e[e.SF64=62]="SF64",e[e.NEWFUNCTION=64]="NEWFUNCTION",e[e.CALL=65]="CALL",e[e.CONSTRUCT=66]="CONSTRUCT",e[e.CALLMETHOD=67]="CALLMETHOD",e[e.CALLSTATIC=68]="CALLSTATIC",e[e.CALLSUPER=69]="CALLSUPER",e[e.CALLPROPERTY=70]="CALLPROPERTY",e[e.RETURNVOID=71]="RETURNVOID",e[e.RETURNVALUE=72]="RETURNVALUE",e[e.CONSTRUCTSUPER=73]="CONSTRUCTSUPER",e[e.CONSTRUCTPROP=74]="CONSTRUCTPROP",e[e.CALLSUPERID=75]="CALLSUPERID",e[e.CALLPROPLEX=76]="CALLPROPLEX",e[e.CALLINTERFACE=77]="CALLINTERFACE",e[e.CALLSUPERVOID=78]="CALLSUPERVOID",e[e.CALLPROPVOID=79]="CALLPROPVOID",e[e.SXI1=80]="SXI1",e[e.SXI8=81]="SXI8",e[e.SXI16=82]="SXI16",e[e.APPLYTYPE=83]="APPLYTYPE",e[e.PUSHFLOAT4=84]="PUSHFLOAT4",e[e.NEWOBJECT=85]="NEWOBJECT",e[e.NEWARRAY=86]="NEWARRAY",e[e.NEWACTIVATION=87]="NEWACTIVATION",e[e.NEWCLASS=88]="NEWCLASS",e[e.GETDESCENDANTS=89]="GETDESCENDANTS",e[e.NEWCATCH=90]="NEWCATCH",e[e.FINDPROPSTRICT=93]="FINDPROPSTRICT",e[e.FINDPROPERTY=94]="FINDPROPERTY",e[e.FINDDEF=95]="FINDDEF",e[e.GETLEX=96]="GETLEX",e[e.SETPROPERTY=97]="SETPROPERTY",e[e.GETLOCAL=98]="GETLOCAL",e[e.SETLOCAL=99]="SETLOCAL",e[e.GETGLOBALSCOPE=100]="GETGLOBALSCOPE",e[e.GETSCOPEOBJECT=101]="GETSCOPEOBJECT",e[e.GETPROPERTY=102]="GETPROPERTY",e[e.GETOUTERSCOPE=103]="GETOUTERSCOPE",e[e.INITPROPERTY=104]="INITPROPERTY",e[e.UNUSED_69=105]="UNUSED_69",e[e.DELETEPROPERTY=106]="DELETEPROPERTY",e[e.UNUSED_6B=107]="UNUSED_6B",e[e.GETSLOT=108]="GETSLOT",e[e.SETSLOT=109]="SETSLOT",e[e.GETGLOBALSLOT=110]="GETGLOBALSLOT",e[e.SETGLOBALSLOT=111]="SETGLOBALSLOT",e[e.CONVERT_S=112]="CONVERT_S",e[e.ESC_XELEM=113]="ESC_XELEM",e[e.ESC_XATTR=114]="ESC_XATTR",e[e.CONVERT_I=115]="CONVERT_I",e[e.CONVERT_U=116]="CONVERT_U",e[e.CONVERT_D=117]="CONVERT_D",e[e.CONVERT_B=118]="CONVERT_B",e[e.CONVERT_O=119]="CONVERT_O",e[e.CHECKFILTER=120]="CHECKFILTER",e[e.CONVERT_F=121]="CONVERT_F",e[e.UNPLUS=122]="UNPLUS",e[e.CONVERT_F4=123]="CONVERT_F4",e[e.BC_7C=124]="BC_7C",e[e.BC_7D=125]="BC_7D",e[e.BC_7E=126]="BC_7E",e[e.BC_7F=127]="BC_7F",e[e.COERCE=128]="COERCE",e[e.COERCE_B=129]="COERCE_B",e[e.COERCE_A=130]="COERCE_A",e[e.COERCE_I=131]="COERCE_I",e[e.COERCE_D=132]="COERCE_D",e[e.COERCE_S=133]="COERCE_S",e[e.ASTYPE=134]="ASTYPE",e[e.ASTYPELATE=135]="ASTYPELATE",e[e.COERCE_U=136]="COERCE_U",e[e.COERCE_O=137]="COERCE_O",e[e.NEGATE=144]="NEGATE",e[e.INCREMENT=145]="INCREMENT",e[e.INCLOCAL=146]="INCLOCAL",e[e.DECREMENT=147]="DECREMENT",e[e.DECLOCAL=148]="DECLOCAL",e[e.TYPEOF=149]="TYPEOF",e[e.NOT=150]="NOT",e[e.BITNOT=151]="BITNOT",e[e.UNUSED_98=152]="UNUSED_98",e[e.UNUSED_99=153]="UNUSED_99",e[e.UNUSED_9A=154]="UNUSED_9A",e[e.UNUSED_9B=155]="UNUSED_9B",e[e.UNUSED_9C=156]="UNUSED_9C",e[e.UNUSED_9D=157]="UNUSED_9D",e[e.UNUSED_9E=158]="UNUSED_9E",e[e.UNUSED_9F=159]="UNUSED_9F",e[e.ADD=160]="ADD",e[e.SUBTRACT=161]="SUBTRACT",e[e.MULTIPLY=162]="MULTIPLY",e[e.DIVIDE=163]="DIVIDE",e[e.MODULO=164]="MODULO",e[e.LSHIFT=165]="LSHIFT",e[e.RSHIFT=166]="RSHIFT",e[e.URSHIFT=167]="URSHIFT",e[e.BITAND=168]="BITAND",e[e.BITOR=169]="BITOR",e[e.BITXOR=170]="BITXOR",e[e.EQUALS=171]="EQUALS",e[e.STRICTEQUALS=172]="STRICTEQUALS",e[e.LESSTHAN=173]="LESSTHAN",e[e.LESSEQUALS=174]="LESSEQUALS",e[e.GREATERTHAN=175]="GREATERTHAN",e[e.GREATEREQUALS=176]="GREATEREQUALS",e[e.INSTANCEOF=177]="INSTANCEOF",e[e.ISTYPE=178]="ISTYPE",e[e.ISTYPELATE=179]="ISTYPELATE",e[e.IN=180]="IN",e[e.UNUSED_B5=181]="UNUSED_B5",e[e.UNUSED_B6=182]="UNUSED_B6",e[e.UNUSED_B7=183]="UNUSED_B7",e[e.UNUSED_B8=184]="UNUSED_B8",e[e.UNUSED_B9=185]="UNUSED_B9",e[e.UNUSED_BA=186]="UNUSED_BA",e[e.UNUSED_BB=187]="UNUSED_BB",e[e.UNUSED_BC=188]="UNUSED_BC",e[e.UNUSED_BD=189]="UNUSED_BD",e[e.UNUSED_BE=190]="UNUSED_BE",e[e.UNUSED_BF=191]="UNUSED_BF",e[e.INCREMENT_I=192]="INCREMENT_I",e[e.DECREMENT_I=193]="DECREMENT_I",e[e.INCLOCAL_I=194]="INCLOCAL_I",e[e.DECLOCAL_I=195]="DECLOCAL_I",e[e.NEGATE_I=196]="NEGATE_I",e[e.ADD_I=197]="ADD_I",e[e.SUBTRACT_I=198]="SUBTRACT_I",e[e.MULTIPLY_I=199]="MULTIPLY_I",e[e.UNUSED_C8=200]="UNUSED_C8",e[e.UNUSED_C9=201]="UNUSED_C9",e[e.UNUSED_CA=202]="UNUSED_CA",e[e.UNUSED_CB=203]="UNUSED_CB",e[e.UNUSED_CC=204]="UNUSED_CC",e[e.UNUSED_CD=205]="UNUSED_CD",e[e.UNUSED_CE=206]="UNUSED_CE",e[e.UNUSED_CF=207]="UNUSED_CF",e[e.GETLOCAL0=208]="GETLOCAL0",e[e.GETLOCAL1=209]="GETLOCAL1",e[e.GETLOCAL2=210]="GETLOCAL2",e[e.GETLOCAL3=211]="GETLOCAL3",e[e.SETLOCAL0=212]="SETLOCAL0",e[e.SETLOCAL1=213]="SETLOCAL1",e[e.SETLOCAL2=214]="SETLOCAL2",e[e.SETLOCAL3=215]="SETLOCAL3",e[e.UNUSED_D8=216]="UNUSED_D8",e[e.UNUSED_D9=217]="UNUSED_D9",e[e.UNUSED_DA=218]="UNUSED_DA",e[e.UNUSED_DB=219]="UNUSED_DB",e[e.UNUSED_DC=220]="UNUSED_DC",e[e.UNUSED_DD=221]="UNUSED_DD",e[e.UNUSED_DE=222]="UNUSED_DE",e[e.UNUSED_DF=223]="UNUSED_DF",e[e.UNUSED_E0=224]="UNUSED_E0",e[e.UNUSED_E1=225]="UNUSED_E1",e[e.UNUSED_E2=226]="UNUSED_E2",e[e.UNUSED_E3=227]="UNUSED_E3",e[e.UNUSED_E4=228]="UNUSED_E4",e[e.UNUSED_E5=229]="UNUSED_E5",e[e.UNUSED_E6=230]="UNUSED_E6",e[e.UNUSED_E7=231]="UNUSED_E7",e[e.UNUSED_E8=232]="UNUSED_E8",e[e.UNUSED_E9=233]="UNUSED_E9",e[e.UNUSED_EA=234]="UNUSED_EA",e[e.UNUSED_EB=235]="UNUSED_EB",e[e.UNUSED_EC=236]="UNUSED_EC",e[e.UNUSED_ED=237]="UNUSED_ED",e[e.UNUSED_EE=238]="UNUSED_EE",e[e.INVALID=237]="INVALID",e[e.false=239]="false",e[e.falseLINE=240]="falseLINE",e[e.falseFILE=241]="falseFILE",e[e.BKPTLINE=242]="BKPTLINE",e[e.TIMESTAMP=243]="TIMESTAMP",e[e.RESTARGC=244]="RESTARGC",e[e.RESTARG=245]="RESTARG",e[e.UNUSED_F6=246]="UNUSED_F6",e[e.UNUSED_F7=247]="UNUSED_F7",e[e.UNUSED_F8=248]="UNUSED_F8",e[e.UNUSED_F9=249]="UNUSED_F9",e[e.UNUSED_FA=250]="UNUSED_FA",e[e.UNUSED_FB=251]="UNUSED_FB",e[e.UNUSED_FC=252]="UNUSED_FC",e[e.UNUSED_FD=253]="UNUSED_FD",e[e.UNUSED_FE=254]="UNUSED_FE",e[e.END=255]="END"}(Nt||(Nt={}));const yt={[Nt.KILL]:"3",[Nt.IFNLT]:"2",[Nt.IFNGT]:"2",[Nt.IFNGE]:"2",[Nt.JUMP]:"2",[Nt.IFTRUE]:"2",[Nt.IFFALSE]:"2",[Nt.IFEQ]:"2",[Nt.IFNE]:"2",[Nt.IFLT]:"2",[Nt.IFLE]:"2",[Nt.IFGT]:"2",[Nt.IFGE]:"2",[Nt.LOOKUPSWITCH]:"LOOKUPSWITCH",[Nt.PUSHBYTE]:"8",[Nt.PUSHSHORT]:"3",[Nt.PUSHSTRING]:"3",[Nt.PUSHINT]:"3",[Nt.PUSHUINT]:"3",[Nt.PUSHNAMESPACE]:"3",[Nt.HASNEXT2]:"33",[Nt.NEWFUNCTION]:"3",[Nt.CALL]:"3",[Nt.CONSTRUCT]:"3",[Nt.CONSTRUCTSUPER]:"3",[Nt.CONSTRUCTPROP]:"33",[Nt.CALLSUPER]:"33",[Nt.CALLSUPERVOID]:"33",[Nt.CALLPROPLEX]:"33",[Nt.CALLPROPERTY]:"33",[Nt.CALLPROPVOID]:"33",[Nt.APPLYTYPE]:"3",[Nt.NEWOBJECT]:"3",[Nt.NEWARRAY]:"3",[Nt.NEWCLASS]:"3",[Nt.GETDESCENDANTS]:"3",[Nt.NEWCATCH]:"3",[Nt.FINDPROPERTY]:"3",[Nt.FINDPROPSTRICT]:"3",[Nt.FINDDEF]:"3",[Nt.GETLEX]:"3",[Nt.INITPROPERTY]:"3",[Nt.SETPROPERTY]:"3",[Nt.GETLOCAL]:"3",[Nt.SETLOCAL]:"3",[Nt.GETSCOPEOBJECT]:"3",[Nt.GETPROPERTY]:"3",[Nt.DELETEPROPERTY]:"3",[Nt.GETSLOT]:"3",[Nt.SETSLOT]:"3",[Nt.COERCE]:"3",[Nt.INCLOCAL_I]:"3",[Nt.DECLOCAL_I]:"3",[Nt.false]:"33",[Nt.falseLINE]:"3",[Nt.falseFILE]:"3"};let Ut,Tt=new Map,vt=new Map;Ut="undefined"!=typeof performance?()=>performance.now():"undefined"!=typeof process?()=>{const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>(new Date).getTime();const Ct=new Qe("Value");class It{constructor(e){this.configurable=!0,this.enumerable=!0,this.writable=!0,this.native=!1,e&&(this.configurable=e.configurable,this.enumerable=e.enumerable,this.value=e.value,this.writable=e.writable,this.native=e.native,this.get=e.get,this.set=e.set)}}class Pt{constructor(e){this.vm=e,this.property=e.vProperty}resolveName(e,t,s=!1,r=e){let a=void 0;const i=this.property.get(r);if(1===t.nsSet.length){const e=t.mangledName;(s||i.has(e))&&(a=e)}else{const e=t.name;for(let s of t.nsSet){const t=_t.MangledName(s,e);if(i.has(t)){a=t;break}}}if(void 0===a){const i=this.vm.vPrototype.get(r);i&&(a=this.resolveName(e,t,s,i))}return s&&void 0===a&&(a=t.mangledName,t.nsSet.length>1&&Ct.warn("More then one namespace found")),a}get(e,t){const s=this.getDescriptor(e,t);if(s)return s.get?s.get.call(e):s.value}init(e,t,s){this.set(e,t,s)}setDescriptor(e,t,s){const r=this.resolveName(e,t,!0);this._setDescriptor(e,r,s)}getDescriptor(e,t){const s=this.resolveName(e,t);return this._getDescriptor(e,s,e)}set(e,t,s){const r=this.resolveName(e,t,!0);this._set(e,r,s,e)}has(e,t){return void 0!==this.resolveName(e,t)}delete(e,t){const s=this.resolveName(e,t,!0);return this.property.get(e).delete(s)}keys(e){const t=this.property.get(e);let s=[];for(let e of t.keys()){if("number"==typeof e){s.push(e.toString());continue}let t=_t.stripPublicMangledName(e);t&&s.push(t)}return s}_set(e,t,s,r){const a=this.property.get(r);if(a.has(t)){const i=a.get(t);if(i.set)return i.set.call(e,s);if(r===e)i.value=s;else{let r=new It(i);r.value=s,this._setDescriptor(e,t,r)}}else{const a=this.vm.vPrototype.get(r);if(a)return this._set(e,t,s,a);this._setDescriptor(e,t,new It({value:s}))}}_setDescriptor(e,t,s){this.property.get(e).set(t,s)}_getDescriptor(e,t,s){const r=this.property.get(s);if(r.has(t))return r.get(t);{const r=this.vm.vPrototype.get(s);if(r)return this._getDescriptor(e,t,r);return}}}class kt extends Pt{constructor(e){super(e),this.traits=e.vTraits,this.slotProps=e.vSlotProps,this.vClass=e.vClass}resolveName(e,t,s=!1,r=e){let a=t.name,i=this.traits.get(e).getTrait(t.nsSet,a);return i?i.name.mangledName:_t.PublicMangledName(a)}bindTrait(e,t){if(this.traits.has(e))throw new Error(`Don't bind Traits twice`);this.traits.set(e,t),this._syncSlot(e)}setSlot(e,t,s){let r=this.slotProps.get(e)[t];if(r.set)return r.set.call(e,s);r.value=s}getSlot(e,t){let s=this.slotProps.get(e)[t];return s.get?s.get.call(e):s.value}get(e,t){let s=super.get(e,t);return s instanceof Function&&(s=this.vm.vApp.get(e).boxFunction(s.bind(e))),s}setClass(e,t){if(this.vClass.has(e))throw new Error("Can not set class twice");this.vClass.set(e,t)}getClass(e){return this.vClass.get(e)}hasPropertyInternal(e,t){return!!this.traits.get(e).getTrait(t.nsSet,t.name)||void 0!==this.property.get(e).get(t.mangledName)}applyTrait(e,t,s,r){t.sec;let a=this.traits.get(e);if(!a)throw new Error("bind traits first");let i=[];for(let e of s){let s,n=new Dt(e.name,e.kindType);switch(e.kindType){case Ye.Method:s=t.createMethodForTrait(e,r),n.value=s;break;case Ye.Getter:n.get=t.createMethodForTrait(e,r);break;case Ye.Setter:n.set=t.createMethodForTrait(e,r);break;case Ye.Slot:case Ye.Const:case Ye.Class:const i=e.data;n.writable=!0,n.value=i.getDefaultValue(),n.typeName=i.typeName,n.slot=i.slotId,a.addSlotTrait(n);break;default:throw new Error("TRAIT type unexcept "+e.kindType)}let o=a.addTrait(n);if(i.push(n),o&&(e.kindType===Ye.Getter||e.kindType===Ye.Setter)){const e=i.indexOf(o);-1!==e&&i.splice(e,1)}}for(let t of i)this.vm.setDescriptor(e,t.name,new It(t));this._syncSlot(e)}_setDescriptor(e,t,s){const r=this.slotProps.get(e),a=this._getDescriptor(e,t,e);if(r){const i=r.indexOf(a);super._setDescriptor(e,t,s),r[i]=s}else super._setDescriptor(e,t,s)}_syncSlot(e){const t=this.traits.get(e);let s=[];for(let r of t.slots)r&&(s[r.slot]=this.getDescriptor(e,r.name));this.slotProps.set(e,s)}}class At{constructor(){this.vProperty=new WeakMap,this.vPrototype=new WeakMap,this.vClass=new WeakMap,this.vTraits=new WeakMap,this.vSlotProps=new WeakMap,this.vApp=new WeakMap,this.defAccesser=new Pt(this),this.traitAccessor=new kt(this),this.vAccesser=new tt(this.defAccesser),this.maps=[this.vProperty,this.vPrototype,this.vClass,this.vTraits,this.vSlotProps,this.vApp,this.vAccesser]}static get instance(){return At._instance}isPrimitive(e){return null===e||void 0===e||"number"==typeof e||"string"==typeof e||"boolean"==typeof e}newObject(e){const t=Object.create(null);return this.registerObject(t,e),t}registerObject(e,t){return!this.vApp.has(e)&&(this.vProperty.set(e,new Map),this.vApp.set(e,t),!0)}replaceObject(e,t){for(let s of this.maps)s.set(t,s.get(e)),s.delete(e);return t}hasPropertyInternal(e,t){const s=this.vAccesser.get(e);if(s instanceof kt)return s.hasPropertyInternal(e,t);throw new Error("Can not hasPropertyInternal")}setSlot(e,t,s){const r=this.vAccesser.get(e);if(r instanceof kt)return r.setSlot(e,t,s);throw new Error("Can not set slot")}getSlot(e,t){const s=this.vAccesser.get(e);if(s instanceof kt)return s.getSlot(e,t);throw new Error("Can not get slot")}getProperty(e,t){return this.vAccesser.get(e).get(e,t)}setProperty(e,t,s){return this.vAccesser.get(e).set(e,t,s)}setDescriptor(e,t,s){return this.vAccesser.get(e).setDescriptor(e,t,s)}initProperty(e,t,s){return this.vAccesser.get(e).init(e,t,s)}hasProperty(e,t){return this.vAccesser.get(e).has(e,t)}deleteProperty(e,t){return this.vAccesser.get(e).delete(e,t)}getEnumerableKeys(e){return this.vAccesser.get(e).keys(e)}getUndefined(){}createClass(e,t,s,r){return null}constructProperty(e,t,s){return this.getProperty(e,t).axNew(...s)}callProperty(e,t,s){let r=this.getProperty(e,t);const a=this.vApp.get(e).sec.flashEmu.hooks.get(t.name);return a&&(r=a.callback),r.call(this,...s)}callSuper(e,t,s,r){let a=s.parent.object.instTrait.getTrait(t.nsSet,t.name).value;if(a)return a.call(e,...r);throw new Error("axCallProperty: could not found Method: "+name)}isPrototypeOf(e,t){const s=this.vPrototype;for(let r=s.get(t);r;r=s.get(r))if(r===e)return!0;return!1}bindTrait(e,t){const s=this.vAccesser.get(e);return s instanceof kt?s.bindTrait(e,t):(this.vAccesser.set(e,this.traitAccessor),this.bindTrait(e,t))}getTrait(e){return this.vTraits.get(e)}applyTrait(e,t,s,r){const a=this.vAccesser.get(e);return a instanceof kt?a.applyTrait(e,t,s,r):(this.vAccesser.set(e,this.traitAccessor),this.applyTrait(e,t,s,r))}setClass(e,t){const s=this.vAccesser.get(e);return s instanceof kt?s.setClass(e,t):(this.vAccesser.set(e,this.traitAccessor),this.setClass(e,t))}getClass(e){const t=this.vAccesser.get(e);if(t instanceof kt)return t.getClass(e);throw new Error("Can not applyTrait")}getProxy(e){const t=this;return{callProperty:(s,...r)=>t.callProperty(e,_t.Public(s),r)}}}At._instance=new At;const Lt=At.instance;class Dt{constructor(e,t){this.name=e,this.kind=t,this.configurable=!0,this.enumerable=!1,this.writable=!0}}class Ot{constructor(e,t,s){this.superTraits=e,this.protectedNs=t,this.protectedNsMappings=s,this._nextSlotID=1,this.slots=[];let r=this.map=new Map;if(e){let t=e.map;for(let[e,s]of t)r.set(e,new Map(s))}}addTrait(e){let t=e.name,s=this.map.get(t.name);s||(s=new Map,this.map.set(t.name,s));const r=t.nsSet[0].mangledName,a=s.get(r);return s.set(r,e),a&&(e.kind===Ye.Setter&&a.get&&(e.get=a.get,e.kind=Ye.GetterSetter),e.kind===Ye.Getter&&a.set&&(e.set=a.set,e.kind=Ye.GetterSetter)),a}addSlotTrait(e){let t=e.slot;t?this._nextSlotID=t+1:t=e.slot=this._nextSlotID++,this.slots[t]=e}getTraitNamespace(e,t){let s=this.map.get(t);if(!s)return null;let r;for(let a=0;a<e.length;a++){let i=e[a];if(r=s.get(i.mangledName))return i;if(i.type===je.Protected){let e=this;for(;e;){if(e.protectedNs===i&&(r=e.protectedNsMappings[t]))return i;e=e.superTraits}}}return null}getTrait(e,t){const s=this.getTraitNamespace(e,t);return s?this.map.get(t).get(s.mangledName):null}}let Rt=new WeakMap;class xt{constructor(e,t,s=!0){this.app=e,this.superCls=t,this.name=null,this.dynamic=!1,Lt.registerObject(this,this.app),s&&t&&t.axNewNative&&(this.axNewNative=t.axNewNative),t&&(this.accessor=t.accessor)}setName(e){const t=e.nsSet[0].uri+"."+e.name;if(null!==this.name)return;const s=this.app.sec.flashEmu.binaryData.get(t);s&&(this.bin=s),this.name=t}applyClass(e,t){this.classInfo=e;this.app.sec;let s=Lt.newObject(this.app);const r=new Ot(null),a=new Ot(this.superCls&&this.superCls.instTrait);this.instTrait=a,this.prototype=s,Lt.bindTrait(this,r),Lt.bindTrait(s,a);const i=this.app;if(e){const r=e.getInstance();Lt.applyTrait(this,i,e.trait,t),Lt.applyTrait(s,i,r.trait,t)}else Lt.applyTrait(s,i,this.superCls.classInfo.getInstance().trait,t)}setPrototypeTrait(e,t){const s=this.app;this.app.sec;this.instTrait=new Ot(null);let r=Lt.newObject(s);this.prototype=r,Lt.bindTrait(r,this.instTrait),Lt.applyTrait(r,s,e,t)}axNewNative(){return Object.create(null)}axNew(...e){let t=this.axNewNative();Lt.registerObject(t,this.app),Lt.vPrototype.set(t,this.prototype),Lt.bindTrait(t,this.instTrait),this.accessor&&Lt.vAccesser.set(t,this.accessor),this.saveReplace(t,this.axConstruct(t,...e));const s=Rt.get(t)||t;return void 0!==s&&s!==t&&Lt.replaceObject(t,s),s}axConstruct(e,...t){return this.instInit&&this.instInit.call(e,...t),e}axSuperConstruct(e,...t){this.superCls&&this.saveReplace(e,this.superCls.axConstruct(e,...t))}axCoerce(e){return e?Lt.isPrimitive(e)?e:(this.name.indexOf("Vector"),e):e}axIsType(e){return!(!e||"object"!=typeof e)&&Lt.isPrototypeOf(this.prototype,e)}saveReplace(e,t){if(e!==t&&void 0!==t){if(Rt.has(e))throw new Error("Do not replace object twice in a axNew");Rt.set(e,t)}}}class Mt extends xt{constructor(e,t,s){super(e,s,!1),this.name=t}axNewNative(){return Object.create(null)}axConstruct(e,...t){throw new Error("Abstract method "+this.name)}axBox(e){throw new Error("Abstract method")}}class Bt{}class Ft extends xt{constructor(e,t){super(e,null),this.app=e,this.name=t}axNewNative(){return new Bt}axConstruct(e,t,s,r){return e.app=t,e.name=s,e.scope=r,e}}const zt=7,Ht=17,Gt=18,Wt=29;var Vt;!function(e){e[e.NEED_ARGUMENTS=1]="NEED_ARGUMENTS",e[e.NEED_ACTIVATION=2]="NEED_ACTIVATION",e[e.NEED_REST=4]="NEED_REST",e[e.HAS_OPTIONAL=8]="HAS_OPTIONAL",e[e.Native=32]="Native",e[e.SET_DXNS=64]="SET_DXNS",e[e.HAS_PARAM_NAMES=128]="HAS_PARAM_NAMES"}(Vt||(Vt={}));var Xt;!function(e){e[e.Int=3]="Int",e[e.UInt=4]="UInt",e[e.Double=6]="Double",e[e.Utf8=1]="Utf8",e[e.True=11]="True",e[e.False=10]="False",e[e.Null=12]="Null",e[e.Undefined=0]="Undefined",e[e.Namespace=8]="Namespace",e[e.PackageNamespace=22]="PackageNamespace",e[e.PackageInternalNs=23]="PackageInternalNs",e[e.ProtectedNamespace=24]="ProtectedNamespace",e[e.ExplicitNamespace=25]="ExplicitNamespace",e[e.StaticProtectedNs=26]="StaticProtectedNs",e[e.PrivateNs=5]="PrivateNs"}(Xt||(Xt={}));var jt;!function(e){e[e.Public=0]="Public",e[e.Protected=1]="Protected",e[e.PackageInternal=2]="PackageInternal",e[e.Private=3]="Private",e[e.Explicit=4]="Explicit",e[e.StaticProtected=5]="StaticProtected"}(jt||(jt={}));var Yt;!function(e){e[e.Slot=0]="Slot",e[e.Method=1]="Method",e[e.Getter=2]="Getter",e[e.Setter=3]="Setter",e[e.Class=4]="Class",e[e.Function=5]="Function",e[e.Const=6]="Const",e[e.GetterSetter=7]="GetterSetter"}(Yt||(Yt={}));var Zt;!function(e){e[e.Final=1]="Final",e[e.Override=2]="Override",e[e.Metadata=4]="Metadata"}(Zt||(Zt={}));var Kt;!function(e){e[e.ClassSealed=1]="ClassSealed",e[e.ClassFinal=2]="ClassFinal",e[e.ClassInterface=4]="ClassInterface",e[e.ClassProtectedNs=8]="ClassProtectedNs"}(Kt||(Kt={}));let Jt={NotImplementedError:{code:1001,message:"The method %1 is not implemented."},InvalidPrecisionError:{code:1002,message:"Number.toPrecision has a range of 1 to 21. Number.toFixed and Number.toExponential have a range of 0 to 20. Specified value is not within expected range."},InvalidRadixError:{code:1003,message:"The radix argument must be between 2 and 36; got %1."},InvokeOnIncompatibleObjectError:{code:1004,message:"Method %1 was invoked on an incompatible object."},ArrayIndexNotIntegerError:{code:1005,message:"Array index is not a positive integer (%1)."},CallOfNonFunctionError:{code:1006,message:"%1 is not a function."},ConstructOfNonFunctionError:{code:1007,message:"Instantiation attempted on a non-constructor."},ConvertNullToObjectError:{code:1009,message:"Cannot access a property or method of a null object reference."},ConvertUndefinedToObjectError:{code:1010,message:"A term is undefined and has no properties."},ClassNotFoundError:{code:1014,message:"Class %1 could not be found."},DescendentsError:{code:1016,message:"Descendants operator (..) not supported on type %1."},StackOverflowError:{code:1023,message:"Stack overflow occurred."},CpoolIndexRangeError:{code:1032,message:"Cpool index %1 is out of range %2."},CpoolEntryWrongTypeError:{code:1033,message:"Cpool entry %1 is wrong type."},CheckTypeFailedError:{code:1034,message:"Type Coercion failed: cannot convert %1 to %2."},CannotAssignToMethodError:{code:1037,message:"Cannot assign to a method %1 on %2."},CantUseInstanceofOnNonObjectError:{code:1040,message:"The right-hand side of instanceof must be a class or function."},IsTypeMustBeClassError:{code:1041,message:"The right-hand side of operator must be a class."},InvalidMagicError:{code:1042,message:"Not an ABC file.  major_version=%1 minor_version=%2."},UnsupportedTraitsKindError:{code:1045,message:"Unsupported traits kind=%1."},PrototypeTypeError:{code:1049,message:"Prototype objects must be vanilla Objects."},ConvertToPrimitiveError:{code:1050,message:"Cannot convert %1 to primitive."},InvalidURIError:{code:1052,message:"Invalid URI passed to %1 function."},WriteSealedError:{code:1056,message:"Cannot create property %1 on %2."},WrongArgumentCountError:{code:1063,message:"Argument count mismatch on %1. Expected %2, got %3."},UndefinedVarError:{code:1065,message:"Variable %1 is not defined."},ReadSealedError:{code:1069,message:"Property %1 not found on %2 and there is no default value."},ConstWriteError:{code:1074,message:"Illegal write to read-only property %1 on %2."},XMLPrefixNotBound:{code:1083,message:"The prefix '%1' for element '%2' is not bound."},XMLUnterminatedElementTag:{code:1085,message:"The element type '%1' must be terminated by the matching end-tag '</%2>'."},XMLOnlyWorksWithOneItemLists:{code:1086,message:"The %1 method only works on lists containing one item."},XMLAssignmentToIndexedXMLNotAllowed:{code:1087,message:"Assignment to indexed XML is not allowed."},XMLMarkupMustBeWellFormed:{code:1088,message:"The markup in the document following the root element must be well-formed."},XMLAssigmentOneItemLists:{code:1089,message:"Assignment to lists with more than one item is not supported."},XMLMalformedElement:{code:1090,message:"XML parser failure: element is malformed."},XMLUnterminatedCData:{code:1091,message:"XML parser failure: Unterminated CDATA section."},XMLUnterminatedXMLDecl:{code:1092,message:"XML parser failure: Unterminated XML declaration."},XMLUnterminatedDocTypeDecl:{code:1093,message:"XML parser failure: Unterminated DOCTYPE declaration."},XMLUnterminatedComment:{code:1094,message:"XML parser failure: Unterminated comment."},XMLUnterminatedElement:{code:1096,message:"XML parser failure: Unterminated element."},XMLNamespaceWithPrefixAndNoURI:{code:1098,message:"Illegal prefix %1 for no namespace."},RegExpFlagsArgumentError:{code:1100,message:"Cannot supply flags when constructing one RegExp from another."},InvalidBaseClassError:{code:1108,message:"The OP_newclass opcode was used with the incorrect base class."},XMLInvalidName:{code:1117,message:"Invalid XML name: %1."},XMLIllegalCyclicalLoop:{code:1118,message:"Illegal cyclical loop between nodes."},FilterError:{code:1123,message:"Filter operator not supported on type %1."},OutOfRangeError:{code:1125,message:"The index %1 is out of range %2."},VectorFixedError:{code:1126,message:"Cannot change the length of a fixed Vector."},TypeAppOfNonParamType:{code:1127,message:"Type application attempted on a non-parameterized type."},WrongTypeArgCountError:{code:1128,message:"Incorrect number of type parameters for %1. Expected %2, got %3."},JSONCyclicStructure:{code:1129,message:"Cyclic structure cannot be converted to JSON string."},JSONInvalidReplacer:{code:1131,message:"Replacer argument to JSON stringifier must be an array or a two parameter function."},JSONInvalidParseInput:{code:1132,message:"Invalid JSON parse input."},InvalidRangeError:{code:1506,message:"The specified range is invalid."},NullArgumentError:{code:1507,message:"Argument %1 cannot be null."},InvalidArgumentError:{code:1508,message:"The value specified for argument %1 is invalid."},ArrayFilterNonNullObjectError:{code:1510,message:"When the callback argument is a method of a class, the optional this argument must be null."},InvalidParamError:{code:2004,message:"One of the parameters is invalid."},ParamRangeError:{code:2006,message:"The supplied index is out of bounds."},NullPointerError:{code:2007,message:"Parameter %1 must be non-null."},InvalidEnumError:{code:2008,message:"Parameter %1 must be one of the accepted values."},CantInstantiateError:{code:2012,message:"%1 class cannot be instantiated."},InvalidBitmapData:{code:2015,message:"Invalid BitmapData."},EOFError:{code:2030,message:"End of file was encountered.",fqn:"flash.errors.EOFError"},CompressedDataError:{code:2058,message:"There was an error decompressing the data.",fqn:"flash.errors.IOError"},EmptyStringError:{code:2085,message:"Parameter %1 must be non-empty string."},ProxyGetPropertyError:{code:2088,message:"The Proxy class does not implement getProperty. It must be overridden by a subclass."},ProxySetPropertyError:{code:2089,message:"The Proxy class does not implement setProperty. It must be overridden by a subclass."},ProxyCallPropertyError:{code:2090,message:"The Proxy class does not implement callProperty. It must be overridden by a subclass."},ProxyHasPropertyError:{code:2091,message:"The Proxy class does not implement hasProperty. It must be overridden by a subclass."},ProxyDeletePropertyError:{code:2092,message:"The Proxy class does not implement deleteProperty. It must be overridden by a subclass."},ProxyGetDescendantsError:{code:2093,message:"The Proxy class does not implement getDescendants. It must be overridden by a subclass."},ProxyNextNameIndexError:{code:2105,message:"The Proxy class does not implement nextNameIndex. It must be overridden by a subclass."},ProxyNextNameError:{code:2106,message:"The Proxy class does not implement nextName. It must be overridden by a subclass."},ProxyNextValueError:{code:2107,message:"The Proxy class does not implement nextValue. It must be overridden by a subclass."},TooFewArgumentsError:{code:2001,message:"Too few arguments were specified; got %1, %2 expected."},ParamTypeError:{code:2005,message:"Parameter %1 is of the incorrect type. Should be type %2."},SocketConnectError:{code:2011,message:"Socket connection failed to %1:%2."},CantAddSelfError:{code:2024,message:"An object cannot be added as a child of itself."},NotAChildError:{code:2025,message:"The supplied DisplayObject must be a child of the caller."},UnhandledError:{code:2044,message:"Unhandled %1:."},FileVerificationError:{code:2046,message:"The loaded file did not have a valid signature."},AllowDomainArgumentError:{code:2052,message:"Only String arguments are permitted for allowDomain and allowInsecureDomain."},DelayRangeError:{code:2066,message:"The Timer delay specified is out of range."},ExternalInterfaceNotAvailableError:{code:2067,message:"The ExternalInterface is not available in this container. ExternalInterface requires Internet Explorer ActiveX, Firefox, Mozilla 1.7.5 and greater, or other browsers that support NPRuntime."},InvalidLoaderMethodError:{code:2069,message:"The Loader class does not implement this method."},InvalidStageMethodError:{code:2071,message:"The Stage class does not implement this property or method."},TimelineObjectNameSealedError:{code:2078,message:"The name property of a Timeline-placed object cannot be modified."},AlreadyConnectedError:{code:2082,message:"Connect failed because the object is already connected."},CloseNotConnectedError:{code:2083,message:"Close failed because the object is not connected."},ArgumentSizeError:{code:2084,message:"The AMF encoding of the arguments cannot exceed 40K."},AsyncError:{code:2095,message:"%1 was unable to invoke callback %2."},LoadingObjectNotSWFError:{code:2098,message:"The loading object is not a .swf file, you cannot request SWF properties from it."},LoadingObjectNotInitializedError:{code:2099,message:"The loading object is not sufficiently loaded to provide this information."},DecodeParamError:{code:2101,message:"The String passed to URLVariables.decode() must be a URL-encoded query string containing name/value pairs."},SceneNotFoundError:{code:2108,message:"Scene %1 was not found."},FrameLabelNotFoundError:{code:2109,message:"Frame label %1 not found in scene %2."},InvalidLoaderInfoMethodError:{code:2118,message:"The LoaderInfo class does not implement this method."},SecuritySwfNotAllowedError:{code:2121,message:"Security sandbox violation: %1: %2 cannot access %3. This may be worked around by calling Security.allowDomain."},UnknownFileTypeError:{code:2124,message:"Loaded file is an unknown type."},CantAddParentError:{code:2150,message:"An object cannot be added as a child to one of it's children (or children's children, etc.)."},Matrix3DRefCannontBeShared:{code:2189,message:"A Matrix3D can not be assigned to more than one DisplayObject."},ObjectWithStringsParamError:{code:2196,message:"Parameter %1 must be an Object with only String values."},AllowCodeImportError:{code:3226,message:"Cannot import a SWF file when LoaderContext.allowCodeImport is false."},PermissionDenied:{code:3315,message:"The current security context does not allow this operation."},InternalErrorIV:{code:3343,message:"Internal Error."}};for(let e in Jt){let t=Jt[e];t.typeName=e,Jt[t.code]=t}const Qt=new Qe("Runtime");var qt;!function(e){e[e.None=0]="None",e[e.Executing=1]="Executing",e[e.Executed=2]="Executed"}(qt||(qt={}));const $t=new WeakMap,es=new WeakMap;class ts{constructor(e,t){this.sec=e,this.parent=t,this.system=t?t.system:this,this.abcs=[],this.triatMethod=this.methodActivation=this.catchScope=new WeakMap,this.findPropertyCache=new Map,this.scriptNameMap=new Map}loadABC(e){if(-1===this.abcs.indexOf(e)){e.app=this;for(let t of e.script){$t.set(t,{state:qt.None,global:null});const e=this.scriptNameMap;for(let s of t.trait){const r=s.name.name;e.has(r)||e.set(r,[]),e.get(r).push(t)}}this.abcs.push(e)}}findProperty(e,t,s){const r=this.findPropertyCache;let a=r.get(e.mangledName);return a||(a=this.findDefiningScript(e,s),r.set(e.mangledName,a)),a?$t.get(a).global:null}getClass(e){return this.getProperty(e,!0,!0)}getProperty(e,t,s){if(!e)return null;let r=this.findProperty(e,t,s);return r?Lt.getProperty(r,e):null}findDefiningScript(e,t){if(this.parent){let s=this.parent.findDefiningScript(e,t);if(s)return s}const s=this.scriptNameMap.get(e.name);if(!s)return null;for(let r of s){const s=$t.get(r);if(r.trait.getTrait(e))return this.prepareGlobal(r),t&&s.state===qt.None&&this.executeScript(r),r}return null}prepareGlobal(e){let t=$t.get(e);if(t.global)return;let s=this.createGlobal(e);t.global=s}executeScript(e){e.abc.app;this.prepareGlobal(e);e.init;let t=$t.get(e),s=t.global;return t.state=qt.Executing,this.sec.flashEmu.interpreter.interpret(s,e.init,s.scope,[],null),t.state=qt.Executed,s}createGlobal(e){const t=`ScriptGlobal${e.getID()}`,s=new rs(null,null),r=new Ft(this,t);r.setPrototypeTrait(e.trait,s);const a=r.axNew(this,t,s);return s.object=a,a}throwError(e,t,...s){let r=t.message;r=t.message.replace(/%(\d)/,(e,t)=>s[t-1]);let a=this.getClass(_t.Public(e));throw new as(a.axNew(r))}createClass(e,t,s){const r=e.holderMeta.filter(e=>"native"===e.name)[0],a=this.sec.flashEmu.interpreter,i=e.getInstance();let n;n=r?U(this,r.get("cls"),t):new xt(this,t);let o=new rs(s,n);return n.applyClass(e,o),n.instInit=function(...e){const t=n.bin;return t&&(this.buf=t.slice(0,t.byteLength)),a.interpret(this,i.iinit,o,e,null)},d(e.cinit.getBody().code)||a.interpret(n,e.cinit,o,[n],null),n}createActivation(e,t){const s=e.getBody();let r=this.methodActivation.get(e);return r||(r=new xt(this)).setPrototypeTrait(s.trait,t),r.axNew()}createCatch(e,t){let s=this.catchScope.get(e);return s||(s=new xt(this)).setPrototypeTrait(e.getTrait(),t),s.axNew()}createMethodForTrait(e,t){let s=e.data,r=this.triatMethod.get(s);if(r)return r;let a=s.method;if(a.isNative()){const t=e.holder;if(t instanceof nt)r=y(this,e);else if(t instanceof pt)r=y(this,e);else if(t instanceof it){const t=e.metadata&&e.metadata.filter(e=>"native"===e.name);if(1!==t.length)throw new Error(`Native global function don't have metadata`);(r=b(this,t[0].value))||Qt.error(`Native function ${t[0].value} not found`)}else Qt.error("Unknown type of trait holder")}else r=this.sec.createFunction(a,t);return this.triatMethod.set(s,r),r}boxFunction(e){const t=this.system.getClass(_t.Public("Function"));return Lt.registerObject(e,this)&&(Lt.vPrototype.set(e,t.prototype),Lt.bindTrait(e,t.instTrait)),e}applyType(e,t){1!==t.length&&this.throwError("TypeError",Jt.WrongTypeArgCountError,"__AS3__.vec::Vector",1,t.length);let s=es.get(t[0]);if(!s){const e=this.getClass(_t.PackageInternal("__AS3__.vec","Vector$object"));(s=new xt(this,e)).name=`Vector.<${t.map(e=>e.name).join(", ")}>`,s.applyClass(null,null),es.set(t[0],s)}return s}}class ss{constructor(e){this.flashEmu=e,this.system=new ts(this,null),this.apps=[this.system],this.vectorClasses=new WeakMap,this.AXClass=U(this.system,"Class",null),Lt.setClass(this.AXClass,this.AXClass),this.AXObject=U(this.system,"ObjectClass",null),this.AXString=U(this.system,"StringClass",this.AXObject),this.AXArray=U(this.system,"ArrayClass",this.AXObject)}onBuiltinLoaded(){this.system}createApplicationDomain(e){if(e=e||this.system,!this.apps.includes(e))throw new Error("createApplicationDomain parent domain should be in sec domain");let t=new ts(this,e);return this.apps.push(t),t}createFunction(e,t,s){const r=this.flashEmu.interpreter;let a=function(...s){return r.interpret(this,e,t,s,a)};return a}box(e){return void 0==e?e:e instanceof Array?this.AXArray.axBox(e):"string"==typeof e?this.AXString.axBox(e):void 0}}class rs{constructor(e,t,s=!1){this.parent=e,this.object=t,this.isWith=s,this.global=e?e.global:this,this.cache=new Map}getScopeProperty(e,t,s){return Lt.getProperty(this.findScopeProperty(e,t,s),e)}findScopeProperty(e,t,s){let r;if(!s&&!e.isRuntime()&&(r=this.cache.get(e.mangledName)))return r;if(this.object&&Lt.hasPropertyInternal(this.object,e))return this.object;if(this.parent)return r=this.parent.findScopeProperty(e,t,s),e.kind===zt&&this.cache.set(e.mangledName,r),r;if(s)return null;const a=this.global.object;return e.isAttribute()&&a.app.throwError("ReferenceError",Jt.UndefinedletError,e.nsSet[0].uri+"."+e.name),(r=a.app.findProperty(e,t,!0))?r:(t&&(Lt.hasProperty(a,e)||a.app.throwError("ReferenceError",Jt.UndefinedVarError,e.nsSet[0].uri+"."+e.name)),a)}}class as{constructor(e){this.error=e}}const is=new Qe("Native");let ns=new Map,os=new Map,ls=new WeakMap,cs=new WeakMap;class hs{constructor(e){this.app=e}}const ds=new Qe("Trace");new Qe("Functions");class us extends hs{print(...e){e=e.map(e=>e&&e.toString()),ds.log(...e)}casi32(e,t,s){const r=this.app.sec.flashEmu.interpreter.getCurrentAPP().domainMemory.view,a=r.getInt32(e,!0);return a===t&&r.setInt32(e,s,!0),a}describeType(){return null}}e([E()],us.prototype,"print",null),e([E()],us.prototype,"casi32",null),e([E()],us.prototype,"describeType",null);let ps=class extends Mt{constructor(e,t,s){super(e,t,s),this.name=t}applyClass(e,t){super.applyClass(e,t);const s=this.prototype;Lt.setProperty(s,_t.Public("toString"),()=>"[object Object]"),Lt.setProperty(s,_t.Public("hasOwnProperty"),e=>"[object Object]")}["_init"](){}axConstruct(e){return{}}};ps=e([_("ObjectClass")],ps);let fs=class extends Mt{};fs=e([_("Class")],fs);class gs extends Error{constructor(...e){super(...e)}}let ms=class extends Mt{axConstruct(e,...t){return new gs(...t)}axIsType(e){return e instanceof gs}};ms=e([_("ReferenceErrorClass")],ms);let _s=class extends Mt{axConstruct(e,...t){return new TypeError(...t)}axIsType(e){return e instanceof TypeError}};_s=e([_("TypeErrorClass")],_s);class Es extends Array{toString(){return super.toString()}}let bs=class extends Mt{constructor(e,t,s){super(e,t,s),this.name=t,this.accessor=new Vs({shouldHandle:e=>"number"==typeof e,set(e,t,s){e[t]=s},get:(e,t)=>e[t],has:(e,t)=>void 0!==e[t],delete:(e,t)=>delete e[t]})}axBox(e){return this.axNew(...e)}axConstruct(e,t){let s=new Es;return t&&(s.length=t),s}};bs=e([_("ArrayClass")],bs);class Ss extends st{constructor(e,t){void 0===t&&(t=e,e=""),super(je.Public,t,e)}toString(){return this.uri}valueOf(){return this.uri}}let ws=class extends Mt{axConstruct(e,t,s){return new Ss(t,s)}};ws=e([_("NamespaceClass")],ws);let Ns=class extends Mt{axNewNative(){return new ys}axConstruct(e,...t){}};Ns=e([_("ByteArrayClass")],Ns);class ys{constructor(){this.position=0,this._length=0,this.littleEndian=!1,this.buf||(this.buf=new ArrayBuffer(0))}get bytesAvailable(){throw 1}set endian(e){this.littleEndian="littleEndian"===e}get endian(){return this.littleEndian?"littleEndian":"bigEndian"}get buf(){return this._buf}set buf(e){this._buf=e,this.reset(),this._length=e.byteLength}get length(){return this._length}set length(e){this.ensureCapacity(e),this._length=e}movePos(e){let t=this.position;return this.position+=e,this.position>this.length&&(this.length=this.position),t}readByte(){const e=this.movePos(1),t=this.view.getInt8(e);return console.error("readByte",e,t),t}readUnsignedByte(){const e=this.movePos(1);return this.view.getUint8(e)}readInt(){const e=this.movePos(4);return this.view.getInt32(e,this.littleEndian)}readUnsignedInt(){const e=this.movePos(4);return this.view.getUint32(e,this.littleEndian)}readUTFBytes(e){const t=this.movePos(e);return i(this.u8view.slice(t,t+e))}readCStyleString(e){let t="";for(let s=0;!0;s++){const r=this.u8view[e+s];if(0===r)return t;t+=String.fromCharCode(r)}}writeByte(e){const t=this.movePos(1);this.view.setInt8(t,e)}writeBytes(e,t=0,s=0){if(!(e instanceof ys))throw new TypeError("writeBytes(bytes)");0===s&&(s=e.length),this._writeBytes(e.buf,t,s)}_writeBytes(e,t=0,s=0){let r=new Uint8Array(e.slice(t,t+s));const a=this.movePos(r.byteLength);this.u8view.set(r,a)}writeUnsignedInt(e){const t=this.movePos(4);this.view.setUint32(t,e,this.littleEndian)}writeInt(e){const t=this.movePos(4);this.view.setInt32(t,e,this.littleEndian)}writeUTFBytes(e){const t=a(e),s=this.movePos(t.byteLength);this.u8view.set(t,s)}ensureCapacity(e){const t=this.buf;if(t.byteLength<e){let s=Math.max(t.byteLength,1);for(;s<e;)s*=2;if(s>4294967295)throw new RangeError("RangeError");const r=new ArrayBuffer(s);new Uint8Array(r).set(new Uint8Array(t)),this.buf=r}}reset(){this.view=new DataView(this.buf),this.u8view=new Uint8Array(this.buf)}}let Us=class extends Mt{get MAX_VALUE(){return Number.MAX_VALUE}get MIN_VALUE(){return Number.MIN_VALUE}get NaN(){return Number.NaN}get NEGATIVE_INFINITY(){return Number.NEGATIVE_INFINITY}get POSITIVE_INFINITY(){return Number.POSITIVE_INFINITY}};Us=e([_("NumberClass")],Us);class Ts{constructor(e=!1){this.dict=new Map}}let vs=class extends Mt{constructor(e,t,s){super(e,t,s),this.name=t,this.accessor=new Vs({shouldHandle:e=>!0,set(e,t,s){e.dict.set(t,s)},get:(e,t)=>e.dict.get(t),has:(e,t)=>e.dict.has(t),delete:(e,t)=>e.dict.delete(t)})}axConstruct(e,t=!1){return new Ts(t)}};vs=e([_("DictionaryClass")],vs);let Cs=class extends Mt{axNewNative(){throw new Error("not imp")}};Cs=e([_("VectorClass")],Cs);class Is extends Array{constructor(){super(...arguments),this.fuckyou=1}toString(){return super.toString()}}let Ps=class extends Mt{constructor(e,t,s){super(e,t,s),this.name=t,this.accessor=new Vs({shouldHandle:e=>"number"==typeof e,set(e,t,s){e[t]=s},get:(e,t)=>e[t],has:(e,t)=>void 0!==e[t],delete:(e,t)=>delete e[t],keys(e){let t=[];for(let s=0;s<e.length;s++)t.push(s);return t}})}axNewNative(){return new Is}axConstruct(e,t){return t&&(e.length=t),e}};Ps=e([_("ObjectVectorClass")],Ps);class ks{call(e,...t){return this.func.call(e,...t)}apply(e,t){return this.call(e,...t)}}let As=class extends Mt{axNewNative(){return new ks}axConstruct(e){return e}applyClass(e,t){super.applyClass(e,t);const s=this.prototype,r=(e,t)=>{Lt.setProperty(s,_t.Public(e),t)};ks.prototype;r("call",function(e,...t){this.call(e,...t)}),r("apply",function(e,t){this.call(e,...t)})}};As=e([_("FunctionClass")],As);class Ls{constructor(e){this.str=e}replace(e,t){return e&&e.native&&(e=e.native),t&&t.native&&(t=t.native),this.str.replace(e,t)}split(e){return e&&e.native&&(e=e.native),this.str.split(e)}substr(e=0,t){return this.str.substr(e,t)}get length(){return this.str.length}set length(e){}}let Ds=class extends Mt{axConstruct(e,t){return new Ls(t)}axCoerce(e){return e?e.toString():e}axBox(e){return this.axNew(e)}};Ds=e([_("StringClass")],Ds);class Os extends Date{toString(){return super.toString()}get time(){return this.getTime()}set time(e){this.setTime(e)}}let Rs=class extends Mt{axConstruct(e,...t){return new Os(...t)}};Rs=e([_("DateClass")],Rs);class xs extends RegExp{constructor(e,t){super(e,t)}}let Ms=class extends Mt{axConstruct(e,...t){return new xs(...t)}};Ms=e([_("RegExpClass")],Ms);let Bs=class extends Mt{axConstruct(e){return e}};Bs=e([_("XMLListClass")],Bs);class Fs{addEventListener(e,t,s,r,a){"addedToStage"===e&&t.call(this)}removeEventListener(e,t,s){}}let zs=class extends Mt{axConstruct(e,...t){return new Fs(...t)}};zs=e([_("EventDispatcherClass")],zs);let Hs=class extends zs{};Hs=e([_()],Hs);class Gs{constructor(e){this.app=e}get domainMemory(){return this.app.domainMemory}set domainMemory(e){this.app.domainMemory=e}}let Ws=class extends Mt{get currentDomain(){const e=this.app.sec.flashEmu.interpreter.getCurrentAPP();return new Gs(e)}get MIN_DOMAIN_MEMORY_LENGTH(){return 1024}};Ws=e([_("ApplicationDomainClass")],Ws);class Vs extends kt{constructor(e){super(Lt),this.handler=e}get(e,t,s=e){return t.nsSet[0].isPublic&&this.handler.shouldHandle(t.name)?this.handler.get(e,t.name):super.get(e,t,s)}set(e,t,s,r=e){return t.nsSet[0].isPublic&&this.handler.shouldHandle(t.name)?this.handler.set(e,t.name,s):super.set(e,t,s,r)}has(e,t){return t.nsSet[0].isPublic&&this.handler.shouldHandle(t.name)?this.handler.has(e,t.name):super.has(e,t)}delete(e,t){return t.nsSet[0].isPublic&&this.handler.shouldHandle(t.name)?this.handler.delete(e,t.name):super.delete(e,t)}keys(e){return this.handler.keys?this.handler.keys(e):super.keys(e)}}new Qe("Interpreter");class Xs{constructor(){this.psc=new WeakMap,this.globalStacks=[],this.Errors=Jt,this.vm=Lt,this.callTable=[];let e=[];for(let t=0;t<256;t++)this[t]&&e.push(t);for(let t of e)this.callTable[t]=this[t]}[Nt.SETLOCAL0]({locals:e,stack:t,bc:s}){e[0]=t.pop()}[Nt.SETLOCAL1]({locals:e,stack:t,bc:s}){e[1]=t.pop()}[Nt.SETLOCAL2]({locals:e,stack:t,bc:s}){e[2]=t.pop()}[Nt.SETLOCAL3]({locals:e,stack:t,bc:s}){e[3]=t.pop()}[Nt.GETLOCAL0]({locals:e,stack:t,bc:s}){t.push(e[0])}[Nt.GETLOCAL1]({locals:e,stack:t,bc:s}){t.push(e[1])}[Nt.GETLOCAL2]({locals:e,stack:t,bc:s}){t.push(e[2])}[Nt.GETLOCAL3]({locals:e,stack:t,bc:s}){t.push(e[3])}[Nt.GETLOCAL]({locals:e,stack:t,bc:s,u30:r}){t.push(e[r()])}[Nt.SETLOCAL]({locals:e,stack:t,u30:s}){e[s()]=t.pop()}[Nt.PUSHSCOPE]({value:e,scopes:t,stack:s,bc:r,u30:a}){e=s.pop(),t.push(e,!1)}[Nt.FINDPROPERTY](e){return this[Nt.FINDPROPSTRICT](e)}[Nt.FINDPROPSTRICT]({scopes:e,value:t,rn:s,stack:r,bc:a,u30:i,abc:n}){this.popNameInto(r,n.getMultiname(i()),s),t=e.topScope().findScopeProperty(s,a===Nt.FINDPROPSTRICT,!1),r.push(t)}[Nt.CONSTRUCT]({app:e,receiver:t,locals:s,stack:r,bc:a,u30:i,args:n}){this.popManyInto(r,i(),n),(t=r.pop())||e.throwError("ReferenceError",this.Errors.ConstructOfNonFunctionError),r.push(t.axNew(...n))}[Nt.CONSTRUCTPROP]({app:e,value:t,receiver:s,abc:r,index:a,rn:i,args:n,stack:o,u30:l}){a=l(),this.popManyInto(o,l(),n),this.popNameInto(o,r.getMultiname(a),i),s=o.pop(),(t=this.vm.getProperty(s,i))||e.throwError("ReferenceError",this.Errors.ConstructOfNonFunctionError),o.push(t.axNew(...n))}[Nt.CONSTRUCTSUPER]({savedScope:e,receiver:t,args:s,locals:r,stack:a,bc:i,u30:n}){this.popManyInto(a,n(),s),t=a.pop(),e.object.axSuperConstruct(t,...s)}[Nt.CALL]({object:e,value:t,args:s,locals:r,stack:a,bc:i,u30:n}){this.popManyInto(a,n(),s),e=a.pop(),t=a[a.length-1],a[a.length-1]=t.call(e,...s)}[Nt.CALLSUPER](e){return this[Nt.CALLSUPERVOID](e)}[Nt.CALLSUPERVOID]({receiver:e,result:t,rn:s,abc:r,args:a,argCount:i,savedScope:n,index:o,locals:l,stack:c,bc:h,u30:d}){o=d(),i=d(),this.popManyInto(c,i,a),this.popNameInto(c,r.getMultiname(o),s),e=c.pop(),t=this.vm.callSuper(e,s,n,a),h!==Nt.CALLSUPERVOID&&c.push(t)}[Nt.NEWFUNCTION]({value:e,sec:t,scopes:s,abc:r,locals:a,stack:i,bc:n,u30:o}){e=t.createFunction(r.getMethod(o()),s.topScope(),!0),i.push(e)}[Nt.FINDDEF]({app:e,value:t,rn:s,abc:r,index:a,locals:i,stack:n,bc:o,u30:l}){a=l(),this.popNameInto(n,r.getMultiname(a),s),t=e.findProperty(s,!0,!0),n.push(t)}[Nt.CALLPROPLEX](e){return this[Nt.CALLPROPVOID](e)}[Nt.CALLPROPERTY](e){return this[Nt.CALLPROPVOID](e)}[Nt.CALLPROPVOID]({result:e,rn:t,abc:s,receiver:r,sec:a,app:i,args:n,argCount:o,index:l,locals:c,stack:h,bc:d,u30:u}){l=u(),o=u(),this.popManyInto(h,o,n),this.popNameInto(h,s.getMultiname(l),t),r=h[h.length-1],this.vm.isPrimitive(r)&&((r=a.box(r))||i.throwError("ReferenceError",this.Errors.NotImplementedError,1,2)),e=this.vm.callProperty(r,t,n),d===Nt.CALLPROPVOID?h.length--:h[h.length-1]=e}[Nt.NOP](e){}[Nt.COERCE_A](e){}[Nt.RETURNVOID]({returnValue:e}){return this.globalStacks.pop(),e(void 0)}[Nt.RETURNVALUE]({value:e,stack:t,returnValue:s}){return e=t.pop(),this.globalStacks.pop(),s(e)}[Nt.PUSHSTRING]({abc:e,stack:t,u30:s}){t.push(e.getString(s()))}[Nt.PUSHTRUE]({stack:e}){e.push(!0)}[Nt.PUSHFALSE]({stack:e}){e.push(!1)}[Nt.PUSHSHORT]({stack:e,u30:t}){e.push(t()<<16>>16)}[Nt.PUSHUNDEFINED]({locals:e,stack:t,bc:s,u30:r}){t.push(void 0)}[Nt.GETGLOBALSCOPE]({savedScope:e,stack:t}){t.push(e.global.object)}[Nt.SWAP]({value:e,locals:t,stack:s,bc:r,u30:a}){e=s[s.length-1],s[s.length-1]=s[s.length-2],s[s.length-2]=e}[Nt.SETSLOT]({value:e,stack:t,receiver:s,u30:r}){e=t.pop(),s=t.pop(),this.vm.setSlot(s,r(),e)}[Nt.PUSHBYTE]({stack:e,s8:t}){e.push(t())}[Nt.ADD]({a:e,b:t,value:s,locals:r,stack:a,bc:i,u30:n}){t=a.pop(),s=a.pop()+t,a.push(s)}[Nt.MULTIPLY]({locals:e,stack:t,bc:s,u30:r}){t[t.length-2]*=t.pop()}[Nt.DIVIDE]({locals:e,stack:t,bc:s,u30:r}){t[t.length-2]/=t.pop()}[Nt.MODULO]({locals:e,stack:t,bc:s,u30:r}){t[t.length-2]%=t.pop()}[Nt.SUBTRACT]({locals:e,stack:t,bc:s,u30:r}){t[t.length-2]-=t.pop()}[Nt.JUMP]({pc:e,s24:t}){e(t())}[Nt.LESSTHAN]({stack:e}){e[e.length-2]=e[e.length-2]<e.pop()}[Nt.LESSEQUALS]({stack:e}){e[e.length-2]=e[e.length-2]<=e.pop()}[Nt.GREATERTHAN]({stack:e}){e[e.length-2]=e[e.length-2]>e.pop()}[Nt.GREATEREQUALS]({stack:e}){e[e.length-2]=e[e.length-2]>=e.pop()}[Nt.IFLE]({stack:e,a:t,b:s,s24:r,pc:a,offset:i}){s=e.pop(),t=e.pop(),i=r(),t<=s&&a(i)}[Nt.IFNLT]({a:e,b:t,stack:s,s24:r,offset:a,pc:i}){t=s.pop(),e=s.pop(),a=r(),e<t||i(a)}[Nt.IFGE]({a:e,b:t,stack:s,s24:r,offset:a,pc:i}){t=s.pop(),e=s.pop(),a=r(),e>=t&&i(a)}[Nt.IFGT]({offset:e,stack:t,a:s,b:r,s24:a,pc:i}){r=t.pop(),s=t.pop(),e=a(),s>r&&i(e)}[Nt.IFNGT]({offset:e,stack:t,a:s,b:r,s24:a,pc:i}){r=t.pop(),s=t.pop(),e=a(),s>r||i(e)}[Nt.IFNGE]({offset:e,stack:t,a:s,b:r,s24:a,pc:i}){r=t.pop(),s=t.pop(),e=a(),s>=r||i(e)}[Nt.IFLT]({offset:e,stack:t,a:s,b:r,s24:a,pc:i}){r=t.pop(),s=t.pop(),e=a(),s<r&&i(e)}[Nt.IFNE]({offset:e,stack:t,a:s,b:r,s24:a,pc:i}){r=t.pop(),s=t.pop(),e=a(),this.axEquals(s,r)||i(e)}[Nt.THROW]({value:e,stack:t}){e=t.pop(),this.throwWrapper(e)}[Nt.GETSLOT]({receiver:e,stack:t,result:s,u30:r}){e=t.pop(),s=this.vm.getSlot(e,r()),t.push(s)}[Nt.LABEL]({locals:e,stack:t,bc:s,u30:r}){}[Nt.INCLOCAL_I]({locals:e,index:t,u30:s}){e[t=s()]=1+(0|e[t])}[Nt.DECLOCAL_I]({locals:e,index:t,u30:s}){e[t=s()]=(0|e[t])-1}[Nt.INCREMENT]({locals:e,stack:t}){++t[t.length-1]}[Nt.DECREMENT]({locals:e,stack:t}){--t[t.length-1]}[Nt.INCREMENT_I]({locals:e,stack:t}){t[t.length-1]=1+(0|t[t.length-1])}[Nt.DECREMENT_I]({locals:e,stack:t}){t[t.length-1]=(0|t[t.length-1])-1}[Nt.KILL]({locals:e,stack:t,u30:s}){e[s()]=void 0}[Nt.POP]({locals:e,stack:t,bc:s,u30:r}){t.pop()}[Nt.GETSCOPEOBJECT]({scopes:e,stack:t,value:s,u30:r}){s=e.get(r()),t.push(s)}[Nt.GETPROPERTY]({receiver:e,sec:t,app:s,result:r,abc:a,stack:i,rn:n,u30:o}){this.popNameInto(i,a.getMultiname(o()),n),e=i.pop(),this.vm.isPrimitive(e)&&(e=t.box(e)),e||s.throwError("ReferenceError",this.Errors.UndefinedVarError,n.name),r=this.vm.getProperty(e,n),i.push(r)}[Nt.DELETEPROPERTY]({locals:e,stack:t,abc:s,u30:r,rn:a,receiver:i}){this.popNameInto(t,s.getMultiname(r()),a),i=t.pop(),t.push(this.vm.deleteProperty(i,a))}[Nt.NEWCLASS]({locals:e,stack:t,value:s,app:r,abc:a,scopes:i,u30:n}){s=t.pop(),s=r.createClass(a.getClass(n()),s,i.topScope()),t.push(s)}[Nt.GETLEX]({locals:e,stack:t,rn:s,object:r,result:a,scopes:i,u30:n,abc:o}){this.popNameInto(t,o.getMultiname(n()),s),r=i.topScope().findScopeProperty(s,!0,!1),a=this.vm.getProperty(r,s),t.push(a)}[Nt.POPSCOPE]({scopes:e}){e.pop()}[Nt.INITPROPERTY]({locals:e,stack:t,rn:s,abc:r,value:a,receiver:i,bc:n,u30:o}){a=t.pop(),this.popNameInto(t,r.getMultiname(o()),s),i=t.pop(),this.vm.initProperty(i,s,a),this.instanceofAXClass(a)&&a.setName(s)}[Nt.SETPROPERTY]({locals:e,stack:t,rn:s,abc:r,value:a,receiver:i,bc:n,u30:o}){a=t.pop(),this.popNameInto(t,r.getMultiname(o()),s),i=t.pop(),this.vm.setProperty(i,s,a)}[Nt.NEWACTIVATION]({scopes:e,methodInfo:t,stack:s,app:r,u30:a}){s.push(r.createActivation(t,e.topScope()))}[Nt.DUP]({locals:e,stack:t,bc:s,u30:r}){t.push(t[t.length-1])}[Nt.PUSHNULL]({locals:e,stack:t,bc:s,u30:r}){t.push(null)}[Nt.NEWARRAY]({locals:e,stack:t,app:s,object:r,u30:a,argCount:i}){r=this.getPublicClass(s,"Array").axNew(),i=a();for(let e=t.length-i;e<t.length;e++)r.push(t[e]);t.length-=i,t.push(r)}[Nt.NOT]({stack:e}){e[e.length-1]=!e[e.length-1]}[Nt.IFTRUE]({pc:e,s24:t,offset:s,stack:r}){s=t(),r.pop()&&e(s)}[Nt.IFFALSE]({pc:e,s24:t,offset:s,stack:r}){s=t(),r.pop()||e(s)}[Nt.NEGATE]({stack:e}){e[e.length-1]=-e[e.length-1]}[Nt.COERCE_S]({locals:e,stack:t,bc:s,u30:r}){t[t.length-1]=this.axCoerceString(t[t.length-1])}[Nt.CONVERT_S]({locals:e,stack:t,bc:s,u30:r}){t[t.length-1]=this.axConvertString(t[t.length-1])}[Nt.COERCE_I](e){return this[Nt.CONVERT_I](e)}[Nt.CONVERT_I]({locals:e,stack:t,bc:s,u30:r}){t[t.length-1]|=0}[Nt.COERCE_B](e){return this[Nt.CONVERT_B](e)}[Nt.CONVERT_B]({locals:e,stack:t,bc:s,u30:r}){t[t.length-1]=!!t[t.length-1]}[Nt.COERCE_U](e){return this[Nt.CONVERT_U](e)}[Nt.CONVERT_U]({locals:e,stack:t,bc:s,u30:r}){t[t.length-1]>>>=0}[Nt.COERCE_D](e){return this[Nt.CONVERT_D](e)}[Nt.CONVERT_D]({locals:e,stack:t,bc:s,u30:r}){t[t.length-1]=+t[t.length-1]}[Nt.COERCE]({locals:e,stack:t,abc:s,rn:r,scopes:a,receiver:i,u30:n}){this.popNameInto(t,s.getMultiname(n()),r),i=a.topScope().getScopeProperty(r,!0,!1),t[t.length-1]=i.axCoerce(t[t.length-1])}[Nt.COERCE_S]({locals:e,stack:t,bc:s,u30:r}){t[t.length-1]=this.axCoerceString(t[t.length-1])}[Nt.APPLYTYPE]({locals:e,stack:t,args:s,app:r,u30:a}){this.popManyInto(t,a(),s),t[t.length-1]=r.applyType(t[t.length-1],s)}[Nt.ISTYPELATE]({stack:e,receiver:t}){t=e.pop(),e[e.length-1]=t.axIsType(e[e.length-1])}[Nt.ASTYPELATE]({value:e,stack:t,receiver:s,u30:r}){s=t.pop(),e=t.pop(),s.axIsType(e)||(e=null),t.push(e)}[Nt.NEWCATCH]({locals:e,stack:t,app:s,u30:r,methodBody:a,scopes:i}){t.push(s.createCatch(a.exception[r()],i.topScope()))}[Nt.NEWOBJECT]({locals:e,stack:t,object:s,value:r,app:a,argCount:i,u30:n}){s=this.getPublicClass(a,"Object").axNew(),i=n();for(let e=t.length-2*i;e<t.length;e+=2)r=t[e+1],this.vm.setProperty(s,this.getPublicMultiname(t[e]),r);t.length-=2*i,t.push(s)}[Nt.falseLINE]({u30:e}){e()}[Nt.falseFILE]({u30:e}){e()}[Nt.false]({pc:e,u30:t}){e(1),t(),e(1),t()}[Nt.PUSHNAN]({locals:e,stack:t,bc:s,u30:r}){t.push(Number.NaN)}[Nt.PUSHINT]({stack:e,abc:t,u30:s}){e.push(t.getInt(s()))}[Nt.PUSHUINT]({stack:e,abc:t,u30:s}){e.push(t.getUInt(s()))}[Nt.PUSHNAMESPACE]({locals:e,stack:t,app:s,abc:r,u30:a}){let i=r.getNamespace(a()),n=this.getPublicClass(s,"Namespace");t.push(n.axNew(i.uri))}[Nt.IFEQ]({a:e,b:t,offset:s,stack:r,pc:a,s24:i}){t=r.pop(),e=r.pop(),s=i(),this.axEquals(e,t)&&a(s)}[Nt.EQUALS]({a:e,b:t,stack:s}){e=s[s.length-2],t=s.pop(),s[s.length-1]=this.axEquals(e,t)}lookupSwitch(e){const t=e.pc-1;let s=e.s24();const r=e.u30(),a=e.stack.pop();a<=r&&(e.pc+=3*a,s=e.s24()),e.pc=t+s}[Nt.LOOKUPSWITCH]({context:e}){this.lookupSwitch(e)}[Nt.TYPEOF]({locals:e,stack:t,bc:s,u30:r}){t[t.length-1]=this.axTypeOf(t[t.length-1])}[Nt.HASNEXT2]({a:e,b:t,result:s,value:r,locals:a,stack:i,object:n,index:o,u30:l}){e=l(),t=l(),n=a[e],r=(o=a[t])<this.vm.getEnumerableKeys(n).length,a[t]=o+1,i.push(r)}[Nt.NEXTNAME]({receiver:e,stack:t,index:s}){s=t.pop(),e=t.pop(),t.push(this.vm.getEnumerableKeys(e)[s-1])}[Nt.NEXTVALUE]({receiver:e,stack:t,index:s}){s=t.pop(),e=t.pop(),s=this.vm.getEnumerableKeys(e)[s-1],t.push(this.vm.getProperty(e,this.getPublicMultiname(s)))}[Nt.CHECKFILTER]({locals:e,stack:t,bc:s,u30:r}){}[Nt.GETDESCENDANTS]({app:e,stack:t,abc:s,rn:r,result:a,u30:i}){this.popNameInto(t,s.getMultiname(i()),r),void 0===r.name&&(r.name="*"),a=this.getPublicClass(e,"Array").axNew(),t[t.length-1]=a}[Nt.LSHIFT]({stack:e}){e[e.length-2]<<=e.pop()}[Nt.RSHIFT]({stack:e}){e[e.length-2]>>=e.pop()}[Nt.URSHIFT]({stack:e}){e[e.length-2]>>>=e.pop()}[Nt.BITAND]({stack:e}){e[e.length-2]&=e.pop()}[Nt.BITXOR]({stack:e}){e[e.length-2]^=e.pop()}[Nt.BITOR]({stack:e}){e[e.length-2]|=e.pop()}[Nt.SI8]({stack:e,a:t,domainMemory:s}){t=e.pop(),s.u8view[t]=e.pop()}[Nt.SI16]({stack:e,a:t,value:s,domainMemory:r}){t=e.pop(),s=e.pop(),r.view.setUint16(t,s,!0)}[Nt.SI32]({stack:e,a:t,value:s,domainMemory:r}){t=e.pop(),s=e.pop(),r.view.setInt32(t,s,!0)}[Nt.SF64]({stack:e,a:t,value:s,domainMemory:r}){t=e.pop(),s=e.pop(),r.view.setFloat64(t,s,!0)}[Nt.LI8]({stack:e,a:t,value:s,domainMemory:r}){e[e.length-1]=r.u8view[e[e.length-1]]}[Nt.LI16]({stack:e,a:t,value:s,domainMemory:r}){t=e.pop(),s=r.view.getUint16(t,!0),e.push(s)}[Nt.LI32]({stack:e,a:t,value:s,domainMemory:r}){t=e.pop(),s=r.view.getInt32(t,!0),e.push(s)}[Nt.LF32]({stack:e,a:t,value:s,domainMemory:r}){t=e.pop(),s=r.view.getFloat32(t,!0),e.push(s)}[Nt.LF64]({stack:e,a:t,value:s,domainMemory:r}){t=e.pop(),s=r.view.getFloat64(t,!0),e.push(s)}[Nt.SXI8]({stack:e,value:t}){t=(t=e.pop())<<24>>24,e.push(t)}[Nt.SXI16]({stack:e,value:t}){t=(t=e.pop())<<16>>16,e.push(t)}getPublicMultiname(e){return _t.Public(e)}getPublicClass(e,t){return e.getClass(_t.Public(t))}popNameInto(e,t,s){if(s._mangledName=null,s.kind=t.kind,s.kind===Wt&&(s.params=t.params),t.isRuntimeName()){let r=e.pop();if(r&&r.axClass)return r=r.name,s.kind=t.isAttribute()?Gt:Ht,s.name=r.name,void(s.nsSet=r.nsSet);s.name=r}else s.name=t.name;if(t.isRuntimeNamespace()){let t=e.pop();s.nsSet=[t]}else s.nsSet=t.nsSet}popManyInto(e,t,s){o(e,t,s)}throwWrapper(e){throw new as(e)}axEquals(e,t){return f(e,t)}axTypeOf(e){return g(e)}axCoerceString(e){return u(e)}axConvertString(e){return p(e)}newMultiname(){return new _t}newScopeStack(e){return new js(e)}newContext(e,t,s,r,a){return new Ys(e,t,s,r,a)}instanceofAXClass(e){return e instanceof xt}procCatch(e,t){if(t instanceof as){const s=e.methodBody,r=e.stack,a=e.scopes,i=e.app.sec,n=e.pc,o=t.error;for(let t of s.exception)if(n>=t.start&&n<=t.end){const s=e.app.getClass(t.excType);if(!s||s.axIsType(o)){if(s);else{let e=o;i.AXObject.axIsType(o)&&(e=o.axClass.name)}return r.length=0,r.push(o),a.clear(),e.pc=t.target,!1}}}throw this.globalStacks.pop(),t}interpret(e,t,s,r,a){let i,n,o=t.abc.app,l=o.sec,c=t.abc,h=c.getMethodBodyByMethod(t),d=this.newContext(e,h,s,r,a),u=d.locals,p=d.stack,f=d.scopes,g=this.newMultiname(),m=o.domainMemory,_=[];this.globalStacks.push(d);let E,b,S,w=!1,N={locals:u,stack:p,bc:i,value:n,object:void 0,a:void 0,b:void 0,args:_,index:void 0,receiver:void 0,result:void 0,context:d,savedScope:s,scopes:f,rn:g,abc:c,sec:l,app:o,methodInfo:t,methodBody:h,argCount:void 0,offset:void 0,domainMemory:m,pc:e=>{d.pc+=e},u30:E=(()=>d.u30()),s8:b=(()=>d.s8()),s24:S=(()=>d.s24()),returnValue:e=>{w=!0,n=e}};for(;!w;){i=d.bc(),N.bc=i;try{this.callTable[i].call(this,N)}catch(e){this.procCatch(d,e)}}if(w)return n}prepare(e){const t=new et(e);let s=[];for(;!t.isEOF();){const e=t.ptr,r=t.readU8(),a=yt[r];if(s[e]=[r],void 0!==a){if("LOOKUPSWITCH"===a){s[e].push(t.ptr);const r=t.readS24();t.ptr=e+r;continue}if(a.length>0)for(let r of a)"2"===r?s[e].push(t.readS24()):"3"===r?s[e].push(t.readU30()):"8"===r&&s[e].push(t.readS8())}s[e].push(t.ptr)}return s}getCurrentAPP(){return 0===this.globalStacks.length?null:this.globalStacks[this.globalStacks.length-1].scopes.topScope().global.object.app}}class js{constructor(e=null){this.parent=e,this.stack=[],this.isWith=[],this.scopes=null}get(e){return this.stack[e]}clear(){this.stack.length=0,this.isWith.length=0}push(e,t=!1){this.stack.push(e),this.isWith.push(t)}pop(){return this.isWith.pop(),this.stack.pop()}topScope(){if(!this.scopes){if(0===this.stack.length)return this.parent;this.scopes=[]}let e=this.parent;for(let t=0;t<this.stack.length;t++){const s=this.stack[t],r=this.isWith[t];let a=this.scopes[t];a&&a.parent===e&&a.object===s&&a.isWith===r||(a=this.scopes[t]=new rs(e,s,r)),e=a}return e}}class Ys{constructor(e,t,s,r,a){let i=t.method;this.methodBody=t,this.methodInfo=i,this.app=i.abc.app,this.stack=[],this.locals=[e],this.scopes=new js(s),this.reader=new et(t.code),this.codeView=new Uint8Array(t.code);const n=i.options.length,o=r.length,l=i.paramType;let c;for(let e=0;e<l.length;e++){c=e<o?r[e]:e<n?i.options[e].val:void 0;let t=l[e];if(t&&!t.isAnyName()){let e=s.getScopeProperty(t,!0,!1);e&&(c=e instanceof xt?e.axCoerce(c):e(c))}this.locals.push(c)}i.needsRest()&&this.locals.push(r.slice(l.length,r.length))}bc(){return this.codeView[this.reader.ptr++]}u30(){return this.reader.readU30()}u8(){return this.reader.readU8()}s8(){return this.reader.readS8()}s24(){return this.reader.readS24()}set pc(e){this.reader.ptr=e}get pc(){return this.reader.ptr}}var Zs=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e,t){var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var s=t.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(var r in s)s.hasOwnProperty(r)&&(e[r]=s[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,s,r,a){if(t.subarray&&e.subarray)e.set(t.subarray(s,s+r),a);else for(var i=0;i<r;i++)e[a+i]=t[s+i]},flattenChunks:function(e){var t,s,r,a,i,n;for(r=0,t=0,s=e.length;t<s;t++)r+=e[t].length;for(n=new Uint8Array(r),a=0,t=0,s=e.length;t<s;t++)i=e[t],n.set(i,a),a+=i.length;return n}},a={arraySet:function(e,t,s,r,a){for(var i=0;i<r;i++)e[a+i]=t[s+i]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(s)}),Ks=4,Js=0,Qs=1,qs=2,$s=0,er=1,tr=2,sr=29,rr=256,ar=rr+1+sr,ir=30,nr=19,or=2*ar+1,lr=15,cr=16,hr=7,dr=256,ur=16,pr=17,fr=18,gr=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],mr=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],_r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Er=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],br=new Array(2*(ar+2));T(br);var Sr=new Array(2*ir);T(Sr);var wr=new Array(512);T(wr);var Nr=new Array(256);T(Nr);var yr=new Array(sr);T(yr);var Ur=new Array(ir);T(Ur);var Tr,vr,Cr,Ir,Pr=!1,kr={_tr_init:function(e){Pr||(x(),Pr=!0),e.l_desc=new C(e.dyn_ltree,Tr),e.d_desc=new C(e.dyn_dtree,vr),e.bl_desc=new C(e.bl_tree,Cr),e.bi_buf=0,e.bi_valid=0,M(e)},_tr_stored_block:K,_tr_flush_block:function(e,t,s,r){var a,i,n=0;e.level>0?(e.strm.data_type===qs&&(e.strm.data_type=Z(e)),W(e,e.l_desc),W(e,e.d_desc),n=j(e),a=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=a&&(a=i)):a=i=s+5,s+4<=a&&-1!==t?K(e,t,s,r):e.strategy===Ks||i===a?(k(e,(er<<1)+(r?1:0),3),G(e,br,Sr)):(k(e,(tr<<1)+(r?1:0),3),Y(e,e.l_desc.max_code+1,e.d_desc.max_code+1,n+1),G(e,e.dyn_ltree,e.dyn_dtree)),M(e),r&&B(e)},_tr_tally:function(e,t,s){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&s,e.last_lit++,0===t?e.dyn_ltree[2*s]++:(e.matches++,t--,e.dyn_ltree[2*(Nr[s]+rr+1)]++,e.dyn_dtree[2*I(t)]++),e.last_lit===e.lit_bufsize-1},_tr_align:function(e){k(e,er<<1,3),A(e,dr,br),D(e)}},Ar=function(e,t,s,r){for(var a=65535&e|0,i=e>>>16&65535|0,n=0;0!==s;){s-=n=s>2e3?2e3:s;do{i=i+(a=a+t[r++]|0)|0}while(--n);a%=65521,i%=65521}return a|i<<16|0},Lr=function(){for(var e,t=[],s=0;s<256;s++){e=s;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[s]=e}return t}(),Dr=function(e,t,s,r){var a=Lr,i=r+s;e^=-1;for(var n=r;n<i;n++)e=e>>>8^a[255&(e^t[n])];return-1^e},Or={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Rr=0,xr=1,Mr=3,Br=4,Fr=5,zr=0,Hr=1,Gr=-2,Wr=-3,Vr=-5,Xr=-1,jr=1,Yr=2,Zr=3,Kr=4,Jr=0,Qr=2,qr=8,$r=9,ea=15,ta=8,sa=286,ra=30,aa=19,ia=2*sa+1,na=15,oa=3,la=258,ca=la+oa+1,ha=32,da=42,ua=69,pa=73,fa=91,ga=103,ma=113,_a=666,Ea=1,ba=2,Sa=3,wa=4,Na=3;Ir=[new he(0,0,0,0,function(e,t){var s=65535;for(s>e.pending_buf_size-5&&(s=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ie(e),0===e.lookahead&&t===Rr)return Ea;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+s;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,ee(e,!1),0===e.strm.avail_out))return Ea;if(e.strstart-e.block_start>=e.w_size-ca&&(ee(e,!1),0===e.strm.avail_out))return Ea}return e.insert=0,t===Br?(ee(e,!0),0===e.strm.avail_out?Sa:wa):(e.strstart>e.block_start&&(ee(e,!1),e.strm.avail_out),Ea)}),new he(4,4,8,4,ne),new he(4,5,16,8,ne),new he(4,6,32,32,ne),new he(4,4,16,16,oe),new he(8,16,32,32,oe),new he(8,16,128,128,oe),new he(8,32,128,256,oe),new he(32,128,258,1024,oe),new he(32,258,258,4096,oe)];var ya={deflateInit:function(e,t){return ge(e,t,qr,ea,ta,Jr)},deflateInit2:ge,deflateReset:fe,deflateResetKeep:pe,deflateSetHeader:function(e,t){return e&&e.state?2!==e.state.wrap?Gr:(e.state.gzhead=t,zr):Gr},deflate:function(e,t){var s,r,a,i;if(!e||!e.state||t>Fr||t<0)return e?J(e,Gr):Gr;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===_a&&t!==Br)return J(e,0===e.avail_out?Vr:Gr);if(r.strm=e,s=r.last_flush,r.last_flush=t,r.status===da)if(2===r.wrap)e.adler=0,te(r,31),te(r,139),te(r,8),r.gzhead?(te(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),te(r,255&r.gzhead.time),te(r,r.gzhead.time>>8&255),te(r,r.gzhead.time>>16&255),te(r,r.gzhead.time>>24&255),te(r,9===r.level?2:r.strategy>=Yr||r.level<2?4:0),te(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(te(r,255&r.gzhead.extra.length),te(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Dr(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=ua):(te(r,0),te(r,0),te(r,0),te(r,0),te(r,0),te(r,9===r.level?2:r.strategy>=Yr||r.level<2?4:0),te(r,Na),r.status=ma);else{var n=qr+(r.w_bits-8<<4)<<8;n|=(r.strategy>=Yr||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(n|=ha),n+=31-n%31,r.status=ma,se(r,n),0!==r.strstart&&(se(r,e.adler>>>16),se(r,65535&e.adler)),e.adler=1}if(r.status===ua)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(e.adler=Dr(e.adler,r.pending_buf,r.pending-a,a)),$(e),a=r.pending,r.pending!==r.pending_buf_size));)te(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(e.adler=Dr(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=pa)}else r.status=pa;if(r.status===pa)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=Dr(e.adler,r.pending_buf,r.pending-a,a)),$(e),a=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,te(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>a&&(e.adler=Dr(e.adler,r.pending_buf,r.pending-a,a)),0===i&&(r.gzindex=0,r.status=fa)}else r.status=fa;if(r.status===fa)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=Dr(e.adler,r.pending_buf,r.pending-a,a)),$(e),a=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,te(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>a&&(e.adler=Dr(e.adler,r.pending_buf,r.pending-a,a)),0===i&&(r.status=ga)}else r.status=ga;if(r.status===ga&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&$(e),r.pending+2<=r.pending_buf_size&&(te(r,255&e.adler),te(r,e.adler>>8&255),e.adler=0,r.status=ma)):r.status=ma),0!==r.pending){if($(e),0===e.avail_out)return r.last_flush=-1,zr}else if(0===e.avail_in&&Q(t)<=Q(s)&&t!==Br)return J(e,Vr);if(r.status===_a&&0!==e.avail_in)return J(e,Vr);if(0!==e.avail_in||0!==r.lookahead||t!==Rr&&r.status!==_a){var o=r.strategy===Yr?ce(r,t):r.strategy===Zr?le(r,t):Ir[r.level].func(r,t);if(o!==Sa&&o!==wa||(r.status=_a),o===Ea||o===Sa)return 0===e.avail_out&&(r.last_flush=-1),zr;if(o===ba&&(t===xr?kr._tr_align(r):t!==Fr&&(kr._tr_stored_block(r,0,0,!1),t===Mr&&(q(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),$(e),0===e.avail_out))return r.last_flush=-1,zr}return t!==Br?zr:r.wrap<=0?Hr:(2===r.wrap?(te(r,255&e.adler),te(r,e.adler>>8&255),te(r,e.adler>>16&255),te(r,e.adler>>24&255),te(r,255&e.total_in),te(r,e.total_in>>8&255),te(r,e.total_in>>16&255),te(r,e.total_in>>24&255)):(se(r,e.adler>>>16),se(r,65535&e.adler)),$(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?zr:Hr)},deflateEnd:function(e){var t;return e&&e.state?(t=e.state.status)!==da&&t!==ua&&t!==pa&&t!==fa&&t!==ga&&t!==ma&&t!==_a?J(e,Gr):(e.state=null,t===ma?J(e,Wr):zr):Gr},deflateSetDictionary:function(e,t){var s,r,a,i,n,o,l,c,h=t.length;if(!e||!e.state)return Gr;if(s=e.state,2===(i=s.wrap)||1===i&&s.status!==da||s.lookahead)return Gr;for(1===i&&(e.adler=Ar(e.adler,t,h,0)),s.wrap=0,h>=s.w_size&&(0===i&&(q(s.head),s.strstart=0,s.block_start=0,s.insert=0),c=new Zs.Buf8(s.w_size),Zs.arraySet(c,t,h-s.w_size,s.w_size,0),t=c,h=s.w_size),n=e.avail_in,o=e.next_in,l=e.input,e.avail_in=h,e.next_in=0,e.input=t,ie(s);s.lookahead>=oa;){r=s.strstart,a=s.lookahead-(oa-1);do{s.ins_h=(s.ins_h<<s.hash_shift^s.window[r+oa-1])&s.hash_mask,s.prev[r&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=r,r++}while(--a);s.strstart=r,s.lookahead=oa-1,ie(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=oa-1,s.match_available=0,e.next_in=o,e.input=l,e.avail_in=n,s.wrap=i,zr},deflateInfo:"pako deflate (from Nodeca project)"},Ua=!0,Ta=!0;try{String.fromCharCode.apply(null,[0])}catch(e){Ua=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Ta=!1}for(var va=new Zs.Buf8(256),Ca=0;Ca<256;Ca++)va[Ca]=Ca>=252?6:Ca>=248?5:Ca>=240?4:Ca>=224?3:Ca>=192?2:1;va[254]=va[254]=1;var Ia={string2buf:function(e){var t,s,r,a,i,n=e.length,o=0;for(a=0;a<n;a++)55296==(64512&(s=e.charCodeAt(a)))&&a+1<n&&56320==(64512&(r=e.charCodeAt(a+1)))&&(s=65536+(s-55296<<10)+(r-56320),a++),o+=s<128?1:s<2048?2:s<65536?3:4;for(t=new Zs.Buf8(o),i=0,a=0;i<o;a++)55296==(64512&(s=e.charCodeAt(a)))&&a+1<n&&56320==(64512&(r=e.charCodeAt(a+1)))&&(s=65536+(s-55296<<10)+(r-56320),a++),s<128?t[i++]=s:s<2048?(t[i++]=192|s>>>6,t[i++]=128|63&s):s<65536?(t[i++]=224|s>>>12,t[i++]=128|s>>>6&63,t[i++]=128|63&s):(t[i++]=240|s>>>18,t[i++]=128|s>>>12&63,t[i++]=128|s>>>6&63,t[i++]=128|63&s);return t},buf2binstring:function(e){return me(e,e.length)},binstring2buf:function(e){for(var t=new Zs.Buf8(e.length),s=0,r=t.length;s<r;s++)t[s]=e.charCodeAt(s);return t},buf2string:function(e,t){var s,r,a,i,n=t||e.length,o=new Array(2*n);for(r=0,s=0;s<n;)if((a=e[s++])<128)o[r++]=a;else if((i=va[a])>4)o[r++]=65533,s+=i-1;else{for(a&=2===i?31:3===i?15:7;i>1&&s<n;)a=a<<6|63&e[s++],i--;i>1?o[r++]=65533:a<65536?o[r++]=a:(a-=65536,o[r++]=55296|a>>10&1023,o[r++]=56320|1023&a)}return me(o,r)},utf8border:function(e,t){var s;for((t=t||e.length)>e.length&&(t=e.length),s=t-1;s>=0&&128==(192&e[s]);)s--;return s<0?t:0===s?t:s+va[e[s]]>t?s:t}},Pa=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},ka=Object.prototype.toString,Aa=0,La=-1,Da=0,Oa=8;_e.prototype.push=function(e,t){var s,r,a=this.strm,i=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=Ia.string2buf(e):"[object ArrayBuffer]"===ka.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new Zs.Buf8(i),a.next_out=0,a.avail_out=i),1!==(s=ya.deflate(a,r))&&s!==Aa)return this.onEnd(s),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==r&&2!==r)||("string"===this.options.to?this.onData(Ia.buf2binstring(Zs.shrinkBuf(a.output,a.next_out))):this.onData(Zs.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==s);return 4===r?(s=ya.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Aa):2!==r||(this.onEnd(Aa),a.avail_out=0,!0)},_e.prototype.onData=function(e){this.chunks.push(e)},_e.prototype.onEnd=function(e){e===Aa&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Zs.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Ra,xa,Ma={Deflate:_e,deflate:Ee,deflateRaw:function(e,t){return t=t||{},t.raw=!0,Ee(e,t)},gzip:function(e,t){return t=t||{},t.gzip=!0,Ee(e,t)}},Ba=function(e,t){var s,r,a,i,n,o,l,c,h,d,u,p,f,g,m,_,E,b,S,w,N,y,U,T,v;s=e.state,r=e.next_in,T=e.input,a=r+(e.avail_in-5),i=e.next_out,v=e.output,n=i-(t-e.avail_out),o=i+(e.avail_out-257),l=s.dmax,c=s.wsize,h=s.whave,d=s.wnext,u=s.window,p=s.hold,f=s.bits,g=s.lencode,m=s.distcode,_=(1<<s.lenbits)-1,E=(1<<s.distbits)-1;e:do{f<15&&(p+=T[r++]<<f,f+=8,p+=T[r++]<<f,f+=8),b=g[p&_];t:for(;;){if(S=b>>>24,p>>>=S,f-=S,0===(S=b>>>16&255))v[i++]=65535&b;else{if(!(16&S)){if(0==(64&S)){b=g[(65535&b)+(p&(1<<S)-1)];continue t}if(32&S){s.mode=12;break e}e.msg="invalid literal/length code",s.mode=30;break e}w=65535&b,(S&=15)&&(f<S&&(p+=T[r++]<<f,f+=8),w+=p&(1<<S)-1,p>>>=S,f-=S),f<15&&(p+=T[r++]<<f,f+=8,p+=T[r++]<<f,f+=8),b=m[p&E];s:for(;;){if(S=b>>>24,p>>>=S,f-=S,!(16&(S=b>>>16&255))){if(0==(64&S)){b=m[(65535&b)+(p&(1<<S)-1)];continue s}e.msg="invalid distance code",s.mode=30;break e}if(N=65535&b,S&=15,f<S&&(p+=T[r++]<<f,(f+=8)<S&&(p+=T[r++]<<f,f+=8)),(N+=p&(1<<S)-1)>l){e.msg="invalid distance too far back",s.mode=30;break e}if(p>>>=S,f-=S,S=i-n,N>S){if((S=N-S)>h&&s.sane){e.msg="invalid distance too far back",s.mode=30;break e}if(y=0,U=u,0===d){if(y+=c-S,S<w){w-=S;do{v[i++]=u[y++]}while(--S);y=i-N,U=v}}else if(d<S){if(y+=c+d-S,(S-=d)<w){w-=S;do{v[i++]=u[y++]}while(--S);if(y=0,d<w){w-=S=d;do{v[i++]=u[y++]}while(--S);y=i-N,U=v}}}else if(y+=d-S,S<w){w-=S;do{v[i++]=u[y++]}while(--S);y=i-N,U=v}for(;w>2;)v[i++]=U[y++],v[i++]=U[y++],v[i++]=U[y++],w-=3;w&&(v[i++]=U[y++],w>1&&(v[i++]=U[y++]))}else{y=i-N;do{v[i++]=v[y++],v[i++]=v[y++],v[i++]=v[y++],w-=3}while(w>2);w&&(v[i++]=v[y++],w>1&&(v[i++]=v[y++]))}break}}break}}while(r<a&&i<o);r-=w=f>>3,p&=(1<<(f-=w<<3))-1,e.next_in=r,e.next_out=i,e.avail_in=r<a?a-r+5:5-(r-a),e.avail_out=i<o?o-i+257:257-(i-o),s.hold=p,s.bits=f},Fa=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],za=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ha=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Ga=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Wa=function(e,t,s,r,a,i,n,o){var l,c,h,d,u,p,f,g,m,_=o.bits,E=0,b=0,S=0,w=0,N=0,y=0,U=0,T=0,v=0,C=0,I=null,P=0,k=new Zs.Buf16(16),A=new Zs.Buf16(16),L=null,D=0;for(E=0;E<=15;E++)k[E]=0;for(b=0;b<r;b++)k[t[s+b]]++;for(N=_,w=15;w>=1&&0===k[w];w--);if(N>w&&(N=w),0===w)return a[i++]=20971520,a[i++]=20971520,o.bits=1,0;for(S=1;S<w&&0===k[S];S++);for(N<S&&(N=S),T=1,E=1;E<=15;E++)if(T<<=1,(T-=k[E])<0)return-1;if(T>0&&(0===e||1!==w))return-1;for(A[1]=0,E=1;E<15;E++)A[E+1]=A[E]+k[E];for(b=0;b<r;b++)0!==t[s+b]&&(n[A[t[s+b]]++]=b);if(0===e?(I=L=n,p=19):1===e?(I=Fa,P-=257,L=za,D-=257,p=256):(I=Ha,L=Ga,p=-1),C=0,b=0,E=S,u=i,y=N,U=0,h=-1,v=1<<N,d=v-1,1===e&&v>852||2===e&&v>592)return 1;for(;;){f=E-U,n[b]<p?(g=0,m=n[b]):n[b]>p?(g=L[D+n[b]],m=I[P+n[b]]):(g=96,m=0),l=1<<E-U,S=c=1<<y;do{a[u+(C>>U)+(c-=l)]=f<<24|g<<16|m|0}while(0!==c);for(l=1<<E-1;C&l;)l>>=1;if(0!==l?(C&=l-1,C+=l):C=0,b++,0==--k[E]){if(E===w)break;E=t[s+n[b]]}if(E>N&&(C&d)!==h){for(0===U&&(U=N),u+=S,T=1<<(y=E-U);y+U<w&&!((T-=k[y+U])<=0);)y++,T<<=1;if(v+=1<<y,1===e&&v>852||2===e&&v>592)return 1;a[h=C&d]=N<<24|y<<16|u-i|0}}return 0!==C&&(a[u+C]=E-U<<24|64<<16|0),o.bits=N,0},Va=0,Xa=1,ja=2,Ya=4,Za=5,Ka=6,Ja=0,Qa=1,qa=2,$a=-2,ei=-3,ti=-4,si=-5,ri=8,ai=1,ii=2,ni=3,oi=4,li=5,ci=6,hi=7,di=8,ui=9,pi=10,fi=11,gi=12,mi=13,_i=14,Ei=15,bi=16,Si=17,wi=18,Ni=19,yi=20,Ui=21,Ti=22,vi=23,Ci=24,Ii=25,Pi=26,ki=27,Ai=28,Li=29,Di=30,Oi=31,Ri=32,xi=852,Mi=592,Bi=15,Fi=!0,zi={inflateReset:Ne,inflateReset2:ye,inflateResetKeep:we,inflateInit:function(e){return Ue(e,Bi)},inflateInit2:Ue,inflate:function(e,t){var s,r,a,i,n,o,l,c,h,d,u,p,f,g,m,_,E,b,S,w,N,y,U,T,v=0,C=new Zs.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return $a;(s=e.state).mode===gi&&(s.mode=mi),n=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,r=e.input,o=e.avail_in,c=s.hold,h=s.bits,d=o,u=l,y=Ja;e:for(;;)switch(s.mode){case ai:if(0===s.wrap){s.mode=mi;break}for(;h<16;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(2&s.wrap&&35615===c){s.check=0,C[0]=255&c,C[1]=c>>>8&255,s.check=Dr(s.check,C,2,0),c=0,h=0,s.mode=ii;break}if(s.flags=0,s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",s.mode=Di;break}if((15&c)!==ri){e.msg="unknown compression method",s.mode=Di;break}if(c>>>=4,h-=4,N=8+(15&c),0===s.wbits)s.wbits=N;else if(N>s.wbits){e.msg="invalid window size",s.mode=Di;break}s.dmax=1<<N,e.adler=s.check=1,s.mode=512&c?pi:gi,c=0,h=0;break;case ii:for(;h<16;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(s.flags=c,(255&s.flags)!==ri){e.msg="unknown compression method",s.mode=Di;break}if(57344&s.flags){e.msg="unknown header flags set",s.mode=Di;break}s.head&&(s.head.text=c>>8&1),512&s.flags&&(C[0]=255&c,C[1]=c>>>8&255,s.check=Dr(s.check,C,2,0)),c=0,h=0,s.mode=ni;case ni:for(;h<32;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}s.head&&(s.head.time=c),512&s.flags&&(C[0]=255&c,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,s.check=Dr(s.check,C,4,0)),c=0,h=0,s.mode=oi;case oi:for(;h<16;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}s.head&&(s.head.xflags=255&c,s.head.os=c>>8),512&s.flags&&(C[0]=255&c,C[1]=c>>>8&255,s.check=Dr(s.check,C,2,0)),c=0,h=0,s.mode=li;case li:if(1024&s.flags){for(;h<16;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}s.length=c,s.head&&(s.head.extra_len=c),512&s.flags&&(C[0]=255&c,C[1]=c>>>8&255,s.check=Dr(s.check,C,2,0)),c=0,h=0}else s.head&&(s.head.extra=null);s.mode=ci;case ci:if(1024&s.flags&&((p=s.length)>o&&(p=o),p&&(s.head&&(N=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Array(s.head.extra_len)),Zs.arraySet(s.head.extra,r,i,p,N)),512&s.flags&&(s.check=Dr(s.check,r,p,i)),o-=p,i+=p,s.length-=p),s.length))break e;s.length=0,s.mode=hi;case hi:if(2048&s.flags){if(0===o)break e;p=0;do{N=r[i+p++],s.head&&N&&s.length<65536&&(s.head.name+=String.fromCharCode(N))}while(N&&p<o);if(512&s.flags&&(s.check=Dr(s.check,r,p,i)),o-=p,i+=p,N)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=di;case di:if(4096&s.flags){if(0===o)break e;p=0;do{N=r[i+p++],s.head&&N&&s.length<65536&&(s.head.comment+=String.fromCharCode(N))}while(N&&p<o);if(512&s.flags&&(s.check=Dr(s.check,r,p,i)),o-=p,i+=p,N)break e}else s.head&&(s.head.comment=null);s.mode=ui;case ui:if(512&s.flags){for(;h<16;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(c!==(65535&s.check)){e.msg="header crc mismatch",s.mode=Di;break}c=0,h=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),e.adler=s.check=0,s.mode=gi;break;case pi:for(;h<32;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}e.adler=s.check=be(c),c=0,h=0,s.mode=fi;case fi:if(0===s.havedict)return e.next_out=n,e.avail_out=l,e.next_in=i,e.avail_in=o,s.hold=c,s.bits=h,qa;e.adler=s.check=1,s.mode=gi;case gi:if(t===Za||t===Ka)break e;case mi:if(s.last){c>>>=7&h,h-=7&h,s.mode=ki;break}for(;h<3;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}switch(s.last=1&c,c>>>=1,h-=1,3&c){case 0:s.mode=_i;break;case 1:if(Te(s),s.mode=yi,t===Ka){c>>>=2,h-=2;break e}break;case 2:s.mode=Si;break;case 3:e.msg="invalid block type",s.mode=Di}c>>>=2,h-=2;break;case _i:for(c>>>=7&h,h-=7&h;h<32;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",s.mode=Di;break}if(s.length=65535&c,c=0,h=0,s.mode=Ei,t===Ka)break e;case Ei:s.mode=bi;case bi:if(p=s.length){if(p>o&&(p=o),p>l&&(p=l),0===p)break e;Zs.arraySet(a,r,i,p,n),o-=p,i+=p,l-=p,n+=p,s.length-=p;break}s.mode=gi;break;case Si:for(;h<14;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(s.nlen=257+(31&c),c>>>=5,h-=5,s.ndist=1+(31&c),c>>>=5,h-=5,s.ncode=4+(15&c),c>>>=4,h-=4,s.nlen>286||s.ndist>30){e.msg="too many length or distance symbols",s.mode=Di;break}s.have=0,s.mode=wi;case wi:for(;s.have<s.ncode;){for(;h<3;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}s.lens[I[s.have++]]=7&c,c>>>=3,h-=3}for(;s.have<19;)s.lens[I[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,U={bits:s.lenbits},y=Wa(Va,s.lens,0,19,s.lencode,0,s.work,U),s.lenbits=U.bits,y){e.msg="invalid code lengths set",s.mode=Di;break}s.have=0,s.mode=Ni;case Ni:for(;s.have<s.nlen+s.ndist;){for(;v=s.lencode[c&(1<<s.lenbits)-1],m=v>>>24,_=v>>>16&255,E=65535&v,!(m<=h);){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(E<16)c>>>=m,h-=m,s.lens[s.have++]=E;else{if(16===E){for(T=m+2;h<T;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(c>>>=m,h-=m,0===s.have){e.msg="invalid bit length repeat",s.mode=Di;break}N=s.lens[s.have-1],p=3+(3&c),c>>>=2,h-=2}else if(17===E){for(T=m+3;h<T;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}h-=m,N=0,p=3+(7&(c>>>=m)),c>>>=3,h-=3}else{for(T=m+7;h<T;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}h-=m,N=0,p=11+(127&(c>>>=m)),c>>>=7,h-=7}if(s.have+p>s.nlen+s.ndist){e.msg="invalid bit length repeat",s.mode=Di;break}for(;p--;)s.lens[s.have++]=N}}if(s.mode===Di)break;if(0===s.lens[256]){e.msg="invalid code -- missing end-of-block",s.mode=Di;break}if(s.lenbits=9,U={bits:s.lenbits},y=Wa(Xa,s.lens,0,s.nlen,s.lencode,0,s.work,U),s.lenbits=U.bits,y){e.msg="invalid literal/lengths set",s.mode=Di;break}if(s.distbits=6,s.distcode=s.distdyn,U={bits:s.distbits},y=Wa(ja,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,U),s.distbits=U.bits,y){e.msg="invalid distances set",s.mode=Di;break}if(s.mode=yi,t===Ka)break e;case yi:s.mode=Ui;case Ui:if(o>=6&&l>=258){e.next_out=n,e.avail_out=l,e.next_in=i,e.avail_in=o,s.hold=c,s.bits=h,Ba(e,u),n=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,r=e.input,o=e.avail_in,c=s.hold,h=s.bits,s.mode===gi&&(s.back=-1);break}for(s.back=0;v=s.lencode[c&(1<<s.lenbits)-1],m=v>>>24,_=v>>>16&255,E=65535&v,!(m<=h);){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(_&&0==(240&_)){for(b=m,S=_,w=E;v=s.lencode[w+((c&(1<<b+S)-1)>>b)],m=v>>>24,_=v>>>16&255,E=65535&v,!(b+m<=h);){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}c>>>=b,h-=b,s.back+=b}if(c>>>=m,h-=m,s.back+=m,s.length=E,0===_){s.mode=Pi;break}if(32&_){s.back=-1,s.mode=gi;break}if(64&_){e.msg="invalid literal/length code",s.mode=Di;break}s.extra=15&_,s.mode=Ti;case Ti:if(s.extra){for(T=s.extra;h<T;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}s.length+=c&(1<<s.extra)-1,c>>>=s.extra,h-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=vi;case vi:for(;v=s.distcode[c&(1<<s.distbits)-1],m=v>>>24,_=v>>>16&255,E=65535&v,!(m<=h);){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(0==(240&_)){for(b=m,S=_,w=E;v=s.distcode[w+((c&(1<<b+S)-1)>>b)],m=v>>>24,_=v>>>16&255,E=65535&v,!(b+m<=h);){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}c>>>=b,h-=b,s.back+=b}if(c>>>=m,h-=m,s.back+=m,64&_){e.msg="invalid distance code",s.mode=Di;break}s.offset=E,s.extra=15&_,s.mode=Ci;case Ci:if(s.extra){for(T=s.extra;h<T;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}s.offset+=c&(1<<s.extra)-1,c>>>=s.extra,h-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){e.msg="invalid distance too far back",s.mode=Di;break}s.mode=Ii;case Ii:if(0===l)break e;if(p=u-l,s.offset>p){if((p=s.offset-p)>s.whave&&s.sane){e.msg="invalid distance too far back",s.mode=Di;break}p>s.wnext?(p-=s.wnext,f=s.wsize-p):f=s.wnext-p,p>s.length&&(p=s.length),g=s.window}else g=a,f=n-s.offset,p=s.length;p>l&&(p=l),l-=p,s.length-=p;do{a[n++]=g[f++]}while(--p);0===s.length&&(s.mode=Ui);break;case Pi:if(0===l)break e;a[n++]=s.length,l--,s.mode=Ui;break;case ki:if(s.wrap){for(;h<32;){if(0===o)break e;o--,c|=r[i++]<<h,h+=8}if(u-=l,e.total_out+=u,s.total+=u,u&&(e.adler=s.check=s.flags?Dr(s.check,a,u,n-u):Ar(s.check,a,u,n-u)),u=l,(s.flags?c:be(c))!==s.check){e.msg="incorrect data check",s.mode=Di;break}c=0,h=0}s.mode=Ai;case Ai:if(s.wrap&&s.flags){for(;h<32;){if(0===o)break e;o--,c+=r[i++]<<h,h+=8}if(c!==(4294967295&s.total)){e.msg="incorrect length check",s.mode=Di;break}c=0,h=0}s.mode=Li;case Li:y=Qa;break e;case Di:y=ei;break e;case Oi:return ti;case Ri:default:return $a}return e.next_out=n,e.avail_out=l,e.next_in=i,e.avail_in=o,s.hold=c,s.bits=h,(s.wsize||u!==e.avail_out&&s.mode<Di&&(s.mode<ki||t!==Ya))&&ve(e,e.output,e.next_out,u-e.avail_out)?(s.mode=Oi,ti):(d-=e.avail_in,u-=e.avail_out,e.total_in+=d,e.total_out+=u,s.total+=u,s.wrap&&u&&(e.adler=s.check=s.flags?Dr(s.check,a,u,e.next_out-u):Ar(s.check,a,u,e.next_out-u)),e.data_type=s.bits+(s.last?64:0)+(s.mode===gi?128:0)+(s.mode===yi||s.mode===Ei?256:0),(0===d&&0===u||t===Ya)&&y===Ja&&(y=si),y)},inflateEnd:function(e){if(!e||!e.state)return $a;var t=e.state;return t.window&&(t.window=null),e.state=null,Ja},inflateGetHeader:function(e,t){var s;return e&&e.state?0==(2&(s=e.state).wrap)?$a:(s.head=t,t.done=!1,Ja):$a},inflateSetDictionary:function(e,t){var s,r,a=t.length;return e&&e.state?0!==(s=e.state).wrap&&s.mode!==fi?$a:s.mode===fi&&(r=1,(r=Ar(r,t,a,0))!==s.check)?ei:ve(e,t,a,a)?(s.mode=Oi,ti):(s.havedict=1,Ja):$a},inflateInfo:"pako inflate (from Nodeca project)"},Hi={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Gi=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Wi=Object.prototype.toString;Ce.prototype.push=function(e,t){var s,r,a,i,n,o,l=this.strm,c=this.options.chunkSize,h=this.options.dictionary,d=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?Hi.Z_FINISH:Hi.Z_NO_FLUSH,"string"==typeof e?l.input=Ia.binstring2buf(e):"[object ArrayBuffer]"===Wi.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new Zs.Buf8(c),l.next_out=0,l.avail_out=c),(s=zi.inflate(l,Hi.Z_NO_FLUSH))===Hi.Z_NEED_DICT&&h&&(o="string"==typeof h?Ia.string2buf(h):"[object ArrayBuffer]"===Wi.call(h)?new Uint8Array(h):h,s=zi.inflateSetDictionary(this.strm,o)),s===Hi.Z_BUF_ERROR&&!0===d&&(s=Hi.Z_OK,d=!1),s!==Hi.Z_STREAM_END&&s!==Hi.Z_OK)return this.onEnd(s),this.ended=!0,!1;l.next_out&&(0!==l.avail_out&&s!==Hi.Z_STREAM_END&&(0!==l.avail_in||r!==Hi.Z_FINISH&&r!==Hi.Z_SYNC_FLUSH)||("string"===this.options.to?(a=Ia.utf8border(l.output,l.next_out),i=l.next_out-a,n=Ia.buf2string(l.output,a),l.next_out=i,l.avail_out=c-i,i&&Zs.arraySet(l.output,l.output,a,i,0),this.onData(n)):this.onData(Zs.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(d=!0)}while((l.avail_in>0||0===l.avail_out)&&s!==Hi.Z_STREAM_END);return s===Hi.Z_STREAM_END&&(r=Hi.Z_FINISH),r===Hi.Z_FINISH?(s=zi.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Hi.Z_OK):r!==Hi.Z_SYNC_FLUSH||(this.onEnd(Hi.Z_OK),l.avail_out=0,!0)},Ce.prototype.onData=function(e){this.chunks.push(e)},Ce.prototype.onEnd=function(e){e===Hi.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Zs.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Vi={Inflate:Ce,inflate:Ie,inflateRaw:function(e,t){return t=t||{},t.raw=!0,Ie(e,t)},ungzip:Ie},Xi={};(0,Zs.assign)(Xi,Ma,Vi,Hi);var ji=Xi.inflate;class Yi{static allocateUint8(e){Yi.u8=new Uint8Array(e)}static allocateUint16(e){Yi.u16=new Uint16Array(e)}static allocateUint32(e){Yi.u32=new Uint32Array(e)}static getUint8(){return Yi.u8||Yi.allocateUint8(10),Yi.u8Index++}static getUint16(){return Yi.u16||Yi.allocateUint16(24),Yi.u16Index++}static getUint32(){return Yi.u32||Yi.allocateUint32(10),Yi.u32Index++}}Yi.u8Index=0,Yi.u16Index=0,Yi.u32Index=0;class Zi{constructor(){this.rangeI=0,this.codeI=1,this.loc1=2,this.loc2=3,this.idPos=13}isFinishedOK(){return 0===this.U32[this.codeI]}init(){this.U32=new Uint32Array(4),this.U16=new Uint16Array(4),this.corrupted=!1,0!==this.inStream[this.idPos++]&&(this.corrupted=!0),this.U32[this.rangeI]=4294967295,this.U32[this.codeI]=0;for(let e=0;e<4;e++)this.U32[this.codeI]=this.U32[this.codeI]<<8|this.inStream[this.idPos++];this.U32[this.codeI]===this.U32[this.rangeI]&&(this.corrupted=!0)}normalize(){this.U32[this.rangeI]<Zi.kTopValue&&(this.U32[this.rangeI]<<=8,this.U32[this.codeI]=this.U32[this.codeI]<<8|this.inStream[this.idPos++])}decodeDirectBits(e){this.U32[this.loc1]=0;do{this.U32[this.rangeI]>>>=1,this.U32[this.codeI]-=this.U32[this.rangeI],this.U32[this.loc2]=0-(this.U32[this.codeI]>>>31),this.U32[this.codeI]+=this.U32[this.rangeI]&this.U32[this.loc2],this.U32[this.codeI]===this.U32[this.rangeI]&&(this.corrupted=!0),this.normalize(),this.U32[this.loc1]<<=1,this.U32[this.loc1]+=this.U32[this.loc2]+1}while(--e);return this.U32[this.loc1]}decodeBit(e,t){return this.U16[0]=e[t],this.U32[2]=(this.U32[0]>>>11)*this.U16[0],this.U32[1]<this.U32[2]?(this.U16[0]+=2048-this.U16[0]>>>5,this.U32[0]=this.U32[2],this.U16[1]=0):(this.U16[0]-=this.U16[0]>>>5,this.U32[1]-=this.U32[2],this.U32[0]-=this.U32[2],this.U16[1]=1),e[t]=this.U16[0],this.U32[0]<16777216&&(this.U32[0]<<=8,this.U32[1]=this.U32[1]<<8|this.inStream[this.idPos++]),this.U16[1]}}Zi.kTopValue=1<<24;class Ki{constructor(){this.outPos=0}create(e){this.buf=new Uint8Array(e),this.pos=0,this.size=e,this.isFull=!1,this.totalPos=0}putByte(e){this.totalPos++,this.buf[this.pos++]=e,this.pos===this.size&&(this.pos=0,this.isFull=!0),this.outStream[this.outPos++]=e}getByte(e){return this.buf[e<=this.pos?this.pos-e:this.size-e+this.pos]}copyMatch(e,t){for(;t>0;t--)this.putByte(this.getByte(e))}checkDistance(e){return e<=this.pos||this.isFull}isEmpty(){return 0===this.pos&&!this.isFull}}class Ji{constructor(e){this.numBits=e,this.probs=new Uint16Array(1<<this.numBits)}static constructArray(e,t){let s=[];for(let r=0;r<t;r++)s[r]=new Ji(e);return s}init(){$i.INIT_PROBS(this.probs)}decode(e){let t=1;for(let s=0;s<this.numBits;s++)t=(t<<1)+e.decodeBit(this.probs,t);return t-(1<<this.numBits)}reverseDecode(e){return $i.BitTreeReverseDecode(this.probs,this.numBits,e)}}class Qi{constructor(){this.choice=new Uint16Array([$i.PROB_INIT_VAL,$i.PROB_INIT_VAL]),this.lowCoder=Ji.constructArray(3,1<<$i.kNumPosBitsMax),this.midCoder=Ji.constructArray(3,1<<$i.kNumPosBitsMax),this.highCoder=new Ji(8)}init(){this.highCoder.init();for(let e=0;e<1<<$i.kNumPosBitsMax;e++)this.lowCoder[e].init(),this.midCoder[e].init()}decode(e,t){return 0===e.decodeBit(this.choice,0)?this.lowCoder[t].decode(e):0===e.decodeBit(this.choice,1)?8+this.midCoder[t].decode(e):16+this.highCoder.decode(e)}}class qi{constructor(){this.posSlotDecoder=Ji.constructArray(6,$i.kNumLenToPosStates),this.alignDecoder=new Ji($i.kNumAlignBits),this.posDecoders=new Uint16Array(1+$i.kNumFullDistances-$i.kEndPosModelIndex),this.isMatch=new Uint16Array($i.kNumStates<<$i.kNumPosBitsMax),this.isRep=new Uint16Array($i.kNumStates),this.isRepG0=new Uint16Array($i.kNumStates),this.isRepG1=new Uint16Array($i.kNumStates),this.isRepG2=new Uint16Array($i.kNumStates),this.isRep0Long=new Uint16Array($i.kNumStates<<$i.kNumPosBitsMax),this.lenDecoder=new Qi,this.repLenDecoder=new Qi,this.rangeDec=new Zi,this.outWindow=new Ki}init(){this.loc1=0|Yi.getUint32(),this.loc2=0|Yi.getUint32(),this.matchBitI=0|Yi.getUint16(),this.matchByteI=0|Yi.getUint16(),this.bitI=0|Yi.getUint16(),this.symbolI=0|Yi.getUint16(),this.prevByteI=0|Yi.getUint16(),this.litStateI=0|Yi.getUint16(),this.initLiterals(),this.initDist(),$i.INIT_PROBS(this.isMatch),$i.INIT_PROBS(this.isRep),$i.INIT_PROBS(this.isRepG0),$i.INIT_PROBS(this.isRepG1),$i.INIT_PROBS(this.isRepG2),$i.INIT_PROBS(this.isRep0Long),this.lenDecoder.init(),this.repLenDecoder.init()}create(){this.outWindow.create(this.dictSize),this.createLiterals()}decodeProperties(e){let t=new Uint8Array(4);if(t[0]=e[0],t[0]>=225)throw new Error("Incorrect LZMA properties");t[1]=t[0]%9,t[0]/=9,t[2]=t[0]/5,t[3]=t[0]%5,this.lc=t[1],this.pb=t[2],this.lp=t[3],this.dictSizeInProperties=0;for(let t=0;t<4;t++)this.dictSizeInProperties|=e[t+1]<<8*t;this.dictSize=this.dictSizeInProperties,this.dictSize<$i.LZMA_DIC_MIN&&(this.dictSize=$i.LZMA_DIC_MIN)}decode(e,t){this.init(),this.rangeDec.init(),e&&(this.outWindow.outStream=new Uint8Array(new ArrayBuffer(t)));let s=0,r=0,a=0,i=0,n=0;for(;;){if(e&&0===t&&!this.markerIsMandatory&&this.rangeDec.isFinishedOK())return $i.LZMA_RES_FINISHED_WITHOUT_MARKER;let o=this.outWindow.totalPos&(1<<this.pb)-1;if(0===this.rangeDec.decodeBit(this.isMatch,(n<<$i.kNumPosBitsMax)+o)){if(e&&0===t)return $i.LZMA_RES_ERROR;this.decodeLiteral(n,s),n=this.updateState_Literal(n),t--;continue}let l;if(0!==this.rangeDec.decodeBit(this.isRep,n)){if(e&&0===t)return $i.LZMA_RES_ERROR;if(this.outWindow.isEmpty())return $i.LZMA_RES_ERROR;if(0===this.rangeDec.decodeBit(this.isRepG0,n)){if(0===this.rangeDec.decodeBit(this.isRep0Long,(n<<$i.kNumPosBitsMax)+o)){n=this.updateState_ShortRep(n),this.outWindow.putByte(this.outWindow.getByte(s+1)),t--;continue}}else{let e;0===this.rangeDec.decodeBit(this.isRepG1,n)?e=r:(0===this.rangeDec.decodeBit(this.isRepG2,n)?e=a:(e=i,i=a),a=r),r=s,s=e}l=this.repLenDecoder.decode(this.rangeDec,o),n=this.updateState_Rep(n)}else{if(i=a,a=r,r=s,l=this.lenDecoder.decode(this.rangeDec,o),n=this.updateState_Match(n),4294967295===(s=this.decodeDistance(l)))return this.rangeDec.isFinishedOK()?$i.LZMA_RES_FINISHED_WITH_MARKER:$i.LZMA_RES_ERROR;if(e&&0===t)return $i.LZMA_RES_ERROR;if(s>=this.dictSize||!this.outWindow.checkDistance(s))return $i.LZMA_RES_ERROR}l+=$i.kMatchMinLen;let c=!1;if(e&&t<l&&(l=t,c=!0),this.outWindow.copyMatch(s+1,l),t-=l,c)return $i.LZMA_RES_ERROR}}createLiterals(){this.litProbs=new Uint16Array(768<<this.lc+this.lp)}initLiterals(){let e=768<<this.lc+this.lp;for(let t=0;t<e;t++)this.litProbs[t]=$i.PROB_INIT_VAL}decodeLiteral(e,t){Yi.u16[this.prevByteI]=0,this.outWindow.isEmpty()||(Yi.u16[this.prevByteI]=this.outWindow.getByte(1)),Yi.u16[this.symbolI]=1,Yi.u16[this.litStateI]=((this.outWindow.totalPos&(1<<this.lp)-1)<<this.lc)+(Yi.u16[this.prevByteI]>>>8-this.lc);let s=768*Yi.u16[this.litStateI]|0;if(e>=7){Yi.u16[this.matchByteI]=this.outWindow.getByte(t+1);do{if(Yi.u16[this.matchBitI]=Yi.u16[this.matchByteI]>>>7&1,Yi.u16[this.matchByteI]<<=1,Yi.u16[this.bitI]=this.rangeDec.decodeBit(this.litProbs,s+(1+Yi.u16[this.matchBitI]<<8)+Yi.u16[this.symbolI]),Yi.u16[this.symbolI]=Yi.u16[this.symbolI]<<1|Yi.u16[this.bitI],Yi.u16[this.matchBitI]!==Yi.u16[this.bitI])break}while(Yi.u16[this.symbolI]<256)}for(;Yi.u16[this.symbolI]<256;)Yi.u16[this.symbolI]=Yi.u16[this.symbolI]<<1|this.rangeDec.decodeBit(this.litProbs,s+Yi.u16[this.symbolI]);this.outWindow.putByte(Yi.u16[this.symbolI]-256)}decodeDistance(e){let t=e;t>$i.kNumLenToPosStates-1&&(t=$i.kNumLenToPosStates-1);let s=this.posSlotDecoder[t].decode(this.rangeDec);if(s<4)return s;let r=(s>>>1)-1;return Yi.u32[this.loc1]=(2|1&s)<<r,s<$i.kEndPosModelIndex?Yi.u32[this.loc1]+=$i.BitTreeReverseDecode(this.posDecoders,r,this.rangeDec,Yi.u32[this.loc1]-s):(Yi.u32[this.loc1]+=this.rangeDec.decodeDirectBits(r-$i.kNumAlignBits)<<$i.kNumAlignBits,Yi.u32[this.loc1]+=this.alignDecoder.reverseDecode(this.rangeDec)),Yi.u32[this.loc1]}initDist(){for(let e=0;e<$i.kNumLenToPosStates;e++)this.posSlotDecoder[e].init();this.alignDecoder.init(),$i.INIT_PROBS(this.posDecoders)}updateState_Literal(e){return e<4?0:e<10?e-3:e-6}updateState_ShortRep(e){return e<7?9:11}updateState_Rep(e){return e<7?8:11}updateState_Match(e){return e<7?7:10}}class $i{constructor(){this.decoder=new qi}static INIT_PROBS(e){for(let t=0;t<e.length;t++)e[t]=this.PROB_INIT_VAL}static BitTreeReverseDecode(e,t,s,r=0){let a=1,i=0;for(let n=0;n<t;n++){let t=s.decodeBit(e,r+a);a<<=1,a+=t,i|=t<<n}return i}decodeSWF(e,t){let s,r=new Uint8Array(5);for(s=0;s<5;s++)r[s]=e[s];this.decoder.decodeProperties(r);let a=t;this.decoder.markerIsMandatory=!1,this.decoder.rangeDec.inStream=e,this.decoder.rangeDec.idPos=5,this.decoder.create();let i=this.decoder.decode(!0,a);if(i===$i.LZMA_RES_ERROR)throw"LZMA decoding error";if(i===$i.LZMA_RES_FINISHED_WITHOUT_MARKER);else{if(i!==$i.LZMA_RES_FINISHED_WITH_MARKER)throw"Internal Error";if(this.decoder.outWindow.outPos!==a)throw"Finished with end marker before than specified size"}return this.decoder.rangeDec.corrupted&&console.log("Warning: LZMA stream is corrupted"),this.decoder.outWindow.outStream}decode(e){let t,s=new Uint8Array(13);for(t=0;t<13;t++)s[t]=e[t];this.decoder.decodeProperties(s);let r=0,a=!1;for(t=0;t<8;t++){let e=s[5+t];255!==e&&(a=!0),r|=e<<8*t}this.decoder.markerIsMandatory=!a,this.decoder.rangeDec.inStream=e,this.decoder.create();let i=this.decoder.decode(a,r);if(i===$i.LZMA_RES_ERROR)throw"LZMA decoding error";if(i===$i.LZMA_RES_FINISHED_WITHOUT_MARKER);else{if(i!==$i.LZMA_RES_FINISHED_WITH_MARKER)throw"Internal Error";if(a&&this.decoder.outWindow.outPos!==r)throw"Finished with end marker before than specified size"}return this.decoder.rangeDec.corrupted&&console.log("Warning: LZMA stream is corrupted"),this.decoder.outWindow.outStream}}$i.LZMA_DIC_MIN=4096,$i.LZMA_RES_ERROR=0,$i.LZMA_RES_FINISHED_WITH_MARKER=1,$i.LZMA_RES_FINISHED_WITHOUT_MARKER=2,$i.kNumBitModelTotalBits=11,$i.kNumMoveBits=5,$i.PROB_INIT_VAL=(1<<$i.kNumBitModelTotalBits)/2,$i.kNumPosBitsMax=4,$i.kNumStates=12,$i.kNumLenToPosStates=4,$i.kNumAlignBits=4,$i.kStartPosModelIndex=4,$i.kEndPosModelIndex=14,$i.kNumFullDistances=1<<($i.kEndPosModelIndex>>>1),$i.kMatchMinLen=2;const en=new $i;let tn=new Map;var sn;!function(e){e[e.uncompressed=70]="uncompressed",e[e.zlibCompressed=67]="zlibCompressed",e[e.lzmaCompressed=90]="lzmaCompressed"}(sn||(sn={}));var rn;!function(e){e[e.End=0]="End",e[e.SymbolClass=76]="SymbolClass",e[e.DoABC=82]="DoABC",e[e.DefineBinaryData=87]="DefineBinaryData"}(rn||(rn={}));class an{constructor(e,t=!1){let s=e.readUI16(),r=s>>6,a=63&s;63===a&&(a=e.readUI32()),this.type=r,this.length=a,t||e.movePtr(a)}toJSON(){let e={type:this.type,length:this.length},t=this.constructor.name;return"Tag"!==t&&(e.className=t),this.data instanceof ArrayBuffer&&(e.data=n(Array.from(new Uint8Array(this.data.slice(0,20))))),e}}let nn=class extends an{constructor(e){super(e,!0);let t=e.getPosition();this.flags=e.readUI32(),this.name=e.readCStyleString();const s=e.getPosition()-t;this.data=e.readArray(this.length-s)}toJSON(){let e=super.toJSON();return e.flags=this.flags,e.name=this.name,e}};nn=e([Ae(rn.DoABC)],nn);let on=class extends an{constructor(e){super(e,!0),this.tag=e.readUI16(),e.readUI32(),this.data=e.readArray(this.length-6)}toJSON(){let e=super.toJSON();return e.tag=this.tag,e.symbolName=this.symbolName,e}};on=e([Ae(rn.DefineBinaryData)],on);let ln=class extends an{constructor(e){super(e,!0),this.symbols=new Map;const t=e.readUI16(),s=this.symbols;for(let r=0;r<t;r++){const t=e.readUI16(),r=e.readCStyleString();s.set(t,r)}}toJSON(){let e=super.toJSON();return e.symbols=this.symbols,e}};ln=e([Ae(rn.SymbolClass)],ln);class cn{constructor(e){this.app=e,this.tags=[]}read(e){return t(this,void 0,void 0,function*(){this.compressType=e.readU8(),e.readU8()===l("W")&&e.readU8()===l("S")||this.app.throwError("VerifyError",Jt.FileVerificationError),this.version=e.readU8(),this.fileLength=e.readUI32();const t=yield this.expandBody(e),s=new et(t),r=new dn(s);this.frameSize=r.readRect(),this.frameRate=r.readFixed8(),this.frameCount=s.readU16(),this.tags=[];for(let e of r.readTags())this.tags.push(e);const a=this.getTags(on),i=this.getTags(ln)[0];if(a.length>0&&!i)throw new Error("SymbolClass not found");for(let e of a)e.symbolName=i.symbols.get(e.tag)})}getTags(e){return this.tags.filter(t=>t.type===e.type)}dropUnusedTags(){this.tags=this.tags.filter(e=>e.constructor!==an);this.tags.filter(e=>e.constructor===nn)}expandBody(e){return t(this,void 0,void 0,function*(){const t=e.getPosition();if(this.compressType===sn.uncompressed)return e.readArray(this.fileLength-t);if(this.compressType===sn.zlibCompressed)return yield Pe(e.readArray(-1));if(this.compressType===sn.lzmaCompressed){e.readUI32();return yield ke(e.readArray(-1),this.fileLength-t)}return null})}toJSON(){return{compressType:sn[this.compressType],version:this.version,fileLength:this.fileLength,frameSize:this.frameSize,frameRate:this.frameRate,frameCount:this.frameCount,tags:this.tags}}}class hn{}class dn{constructor(e){this.reader=e,this.bitPos=0,this.tempByte=0}readFixed(){let e=this.reader.readUI32();return(65535&e)/65536+(e>>16)}readFixed8(){let e=this.reader.readUI16();return(255&e)/256+(e>>8)}readUB(e){if(0===e)return 0;let t=0;0===this.bitPos&&(this.tempByte=this.reader.readU8());for(let s=0;s<e;s++)t+=(this.tempByte>>7-this.bitPos&1)<<e-1-s,8===++this.bitPos&&(this.bitPos=0,s!==e-1&&(this.tempByte=this.reader.readU8()));return t}readSB(e){let t=this.readUB(e);const s=32-e;return t=t<<s>>s}alignByte(){this.bitPos=0}readRect(){let e=new hn;const t=this.readUB(5);return e.Xmin=this.readSB(t),e.Xmax=this.readSB(t),e.Ymin=this.readSB(t),e.Ymax=this.readSB(t),this.alignByte(),e}*readTags(){for(let e=this.readTag();null!==e&&(yield e,e.type!==rn.End);e=this.readTag());}readTag(){try{let e=this.reader.readUI16()>>6;this.reader.movePtr(-2);let t=tn.get(e);return t||(t=an),new t(this.reader)}catch(e){return e instanceof $e||console.error(e),null}}}const un=new Qe("FlashEmu");class pn{constructor(e){this.binaryData=new Map,this.hooks=new Map,this._inited=!1,this.sec=new ss(this),this.app=this.sec.createApplicationDomain(null),this.interpreter=new Xs,this.fi=e}static setLogFilter(e){Qe.logFilter=e}static setGlobalFlags(e){s(e)}static swfBuffer2str(e){return t(this,void 0,void 0,function*(){let s=new pn({readFile(e){return t(this,void 0,void 0,function*(){return null})}}),r=new ss(s).createApplicationDomain(null);const a=new cn(r);yield a.read(new et(e));let i=a.getTags(nn),n="";for(let e of i){const t=new et(e.data);let s=new wt(t,r);n+=JSON.stringify(s,null,2)}return n})}static abcBuffer2str(e){let s=new pn({readFile(e){return t(this,void 0,void 0,function*(){return null})}}),r=new ss(s).createApplicationDomain(null),a=new et(e),i=new wt(a,r);return JSON.stringify(i,null,2)}init(){return t(this,void 0,void 0,function*(){if(!this._inited){this._inited=!0;const e=this.sec.system;yield this.loadABCFile(pn.BUILTIN,e),yield this.loadABCFile(pn.PLAYERGLOBAL,e),this.sec.onBuiltinLoaded()}})}loadABC(e,t){const s=new et(e),r=new wt(s,this.app);t.loadABC(r)}loadABCFile(e,s){return t(this,void 0,void 0,function*(){this._inited||(yield this.init()),this.loadABC(yield this.fi.readFile(e),s)})}getClass(e){return this.app.getClass(e)}getPublicClass(e){return this.app.getClass(_t.Public(e))}getProperty(e,t){return this.app.getProperty(_t.Package(e,t),!0,!0)}setProperty(e,t,s){const r=_t.Package(e,t);let a=this.app.findProperty(r,!0,!0);Lt.setProperty(a,r,s)}executeScript(e=-1,t=-1){e<0&&(e+=this.app.abcs.length);const s=this.app.abcs[e];t<0&&(t+=s.script.length);let r=s.getScript(t);return this.app.executeScript(r)}hookFlascc(e,t,s,r){const a=this;this.hooks.set(e,{name:e,callback:()=>{const e=a.getProperty(t,"ESP"),i=this.app.domainMemory.view;let n=[];for(let t=0;t<s;t++)n.push(i.getUint32(e+4*t,!0));return r.call(this,...n)}})}getVM(){return Lt}loadSWF(e){return t(this,void 0,void 0,function*(){yield this.init();const t=yield this.fi.readFile(e),s=new et(t),r=new cn(this.app);yield r.read(s),this.swf=r;let a=r.getTags(on);for(let e of a)this.binaryData.set(e.symbolName,e.data)})}runSWF(e,s=!0){return t(this,void 0,void 0,function*(){yield this.loadSWF(e),this.swf.dropUnusedTags();const t=this.swf.getTags(nn);for(let e of t)this.loadABC(e.data,this.app);s&&this.executeScript()})}testswf2(e){return t(this,void 0,void 0,function*(){yield this.loadSWF(e),this.swf.dropUnusedTags();const t=this.swf.getTags(nn);for(let e of t)this.loadABC(e.data,this.app);this.app.getClass(_t.Package("com.adobe.flascc","CModule")).callProperty("startAsync");let s=this.getProperty("MyCPP","check"),r=s.call(s,"123");un.error(r)})}testswf(e){return t(this,void 0,void 0,function*(){let t=(new Date).getTime();yield this.loadSWF(e),this.swf.dropUnusedTags();const s=this.swf.getTags(nn);for(let e of s)this.loadABC(e.data,this.app);const r=this.app.findProperty(_t.Package("sample.xx","eax"),!0,!0),a=_t.Public("eax");this.hookFlascc("F__ZN11CCommonFunc6RSHashEj","sample.xx",0,()=>{Lt.setProperty(r,a,0)});const i=this.app.getClass(_t.Package("sample.xx","CModule")),n=this.app.getClass(_t.Public("xx")),o=Lt.getProxy(i),l=Lt.getProxy(n);un.error("CModule get"),o.callProperty("startAsync"),un.error("CModule loaded");const d=()=>{let e=(new Date).getTime(),t=o.callProperty("malloc",4),s=o.callProperty("malloc",4),r=l.callProperty("sub_13",687423,25020488,"D2C2C9675D34594BCD066616B5C9AE44",s,t),a=o.callProperty("read32",t),i=o.callProperty("readString",a,r);un.error(a,i),o.callProperty("free",t),o.callProperty("free",s),un.error("sign time:",(new Date).getTime()-e)};c(),d(),d(),d(),un.error("time:",(new Date).getTime()-t),un.error(h(50)),un.error(h(50,"times"))})}}return pn.BUILTIN="./lib/builtin.abc",pn.PLAYERGLOBAL="./lib/playerglobal.abc",pn});
